/*
 * Copyright (c) 2021, Uppsala universitet.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. Neither the name of the Institute nor the names of its contributors
 *    may be used to endorse or promote products derived from this software
 *    without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE INSTITUTE AND CONTRIBUTORS ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE INSTITUTE OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
 * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
 * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
 * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
 * SUCH DAMAGE.
 *
 * This file is part of the Contiki operating system.
 *
 */

/**
 * \addtogroup csl
 * @{
 * \file
 *         SW-UCB-based channel selection.
 * \author
 *         Konrad Krentz <konrad.krentz@gmail.com>
 *         Alex Kangas <alex.kangas.5644@student.uu.se>
 */

#include "lib/assert.h"
#include "lib/ufix.h"
#include "net/mac/csl/csl-channel-selector.h"
#include "net/mac/csl/csl-nbr.h"
#include <stdbool.h>
#include <stdlib.h>

/* Log configuration */
#include "sys/log.h"
#define LOG_MODULE "CSL"
#define LOG_LEVEL LOG_LEVEL_MAC

struct result {
  uint8_t channel;
  ufix16_t ucb;
};

#if CSL_CHANNEL_SELECTOR_WITH_SW_UCB
#define MAX_PROPOSED_CHANNELS (4)
#define EXPLORATION_TENDENCY_SHIFT (12)
#define EXPLORATION_TENDENCY_EXP (13)
#define LOG_2_E_INV_XI \
  (UFIX16_LOG_2_E_INV >> ( \
      EXPLORATION_TENDENCY_EXP - EXPLORATION_TENDENCY_SHIFT))
#define USE_LOOKUP_TABLE 1
#define WINDOW_SIZE CSL_CHANNEL_SELECTOR_SW_UCB_WINDOW_SIZE

#if USE_LOOKUP_TABLE
#define LN_OFFSET(ln) \
    ((ufix16_t)(ln >> ( \
        16 + EXPLORATION_TENDENCY_EXP - EXPLORATION_TENDENCY_SHIFT)))

static const ufix16_t lns[WINDOW_SIZE] = {
#if WINDOW_SIZE >= 1
  LN_OFFSET(0x0000000000000000),
#endif
#if WINDOW_SIZE >= 2
  LN_OFFSET(0x00000000B17217F7),
#endif
#if WINDOW_SIZE >= 3
  LN_OFFSET(0x00000001193EA7AA),
#endif
#if WINDOW_SIZE >= 4
  LN_OFFSET(0x0000000162E42FEF),
#endif
#if WINDOW_SIZE >= 5
  LN_OFFSET(0x000000019C041F7E),
#endif
#if WINDOW_SIZE >= 6
  LN_OFFSET(0x00000001CAB0BFA2),
#endif
#if WINDOW_SIZE >= 7
  LN_OFFSET(0x00000001F2272AE3),
#endif
#if WINDOW_SIZE >= 8
  LN_OFFSET(0x00000002145647E7),
#endif
#if WINDOW_SIZE >= 9
  LN_OFFSET(0x00000002327D4F55),
#endif
#if WINDOW_SIZE >= 10
  LN_OFFSET(0x000000024D763776),
#endif
#if WINDOW_SIZE >= 11
  LN_OFFSET(0x0000000265DC76EF),
#endif
#if WINDOW_SIZE >= 12
  LN_OFFSET(0x000000027C22D79A),
#endif
#if WINDOW_SIZE >= 13
  LN_OFFSET(0x0000000290A08566),
#endif
#if WINDOW_SIZE >= 14
  LN_OFFSET(0x00000002A39942DA),
#endif
#if WINDOW_SIZE >= 15
  LN_OFFSET(0x00000002B542C729),
#endif
#if WINDOW_SIZE >= 16
  LN_OFFSET(0x00000002C5C85FDF),
#endif
#if WINDOW_SIZE >= 17
  LN_OFFSET(0x00000002D54D783F),
#endif
#if WINDOW_SIZE >= 18
  LN_OFFSET(0x00000002E3EF674D),
#endif
#if WINDOW_SIZE >= 19
  LN_OFFSET(0x00000002F1C6C0C0),
#endif
#if WINDOW_SIZE >= 20
  LN_OFFSET(0x00000002FEE84F6E),
#endif
#if WINDOW_SIZE >= 21
  LN_OFFSET(0x000000030B65D28D),
#endif
#if WINDOW_SIZE >= 22
  LN_OFFSET(0x00000003174E8EE7),
#endif
#if WINDOW_SIZE >= 23
  LN_OFFSET(0x0000000322AFBFBA),
#endif
#if WINDOW_SIZE >= 24
  LN_OFFSET(0x000000032D94EF92),
#endif
#if WINDOW_SIZE >= 25
  LN_OFFSET(0x0000000338083EFD),
#endif
#if WINDOW_SIZE >= 26
  LN_OFFSET(0x0000000342129D5E),
#endif
#if WINDOW_SIZE >= 27
  LN_OFFSET(0x000000034BBBF700),
#endif
#if WINDOW_SIZE >= 28
  LN_OFFSET(0x00000003550B5AD2),
#endif
#if WINDOW_SIZE >= 29
  LN_OFFSET(0x000000035E071979),
#endif
#if WINDOW_SIZE >= 30
  LN_OFFSET(0x0000000366B4DF21),
#endif
#if WINDOW_SIZE >= 31
  LN_OFFSET(0x000000036F19C912),
#endif
#if WINDOW_SIZE >= 32
  LN_OFFSET(0x00000003773A77D7),
#endif
#if WINDOW_SIZE >= 33
  LN_OFFSET(0x000000037F1B1E9A),
#endif
#if WINDOW_SIZE >= 34
  LN_OFFSET(0x0000000386BF9037),
#endif
#if WINDOW_SIZE >= 35
  LN_OFFSET(0x000000038E2B4A61),
#endif
#if WINDOW_SIZE >= 36
  LN_OFFSET(0x0000000395617F45),
#endif
#if WINDOW_SIZE >= 37
  LN_OFFSET(0x000000039C651DC7),
#endif
#if WINDOW_SIZE >= 38
  LN_OFFSET(0x00000003A338D8B8),
#endif
#if WINDOW_SIZE >= 39
  LN_OFFSET(0x00000003A9DF2D11),
#endif
#if WINDOW_SIZE >= 40
  LN_OFFSET(0x00000003B05A6766),
#endif
#if WINDOW_SIZE >= 41
  LN_OFFSET(0x00000003B6ACA8B1),
#endif
#if WINDOW_SIZE >= 42
  LN_OFFSET(0x00000003BCD7EA85),
#endif
#if WINDOW_SIZE >= 43
  LN_OFFSET(0x00000003C2DE02C2),
#endif
#if WINDOW_SIZE >= 44
  LN_OFFSET(0x00000003C8C0A6DF),
#endif
#if WINDOW_SIZE >= 45
  LN_OFFSET(0x00000003CE816ED4),
#endif
#if WINDOW_SIZE >= 46
  LN_OFFSET(0x00000003D421D7B2),
#endif
#if WINDOW_SIZE >= 47
  LN_OFFSET(0x00000003D9A345F2),
#endif
#if WINDOW_SIZE >= 48
  LN_OFFSET(0x00000003DF07078A),
#endif
#if WINDOW_SIZE >= 49
  LN_OFFSET(0x00000003E44E55C6),
#endif
#if WINDOW_SIZE >= 50
  LN_OFFSET(0x00000003E97A56F5),
#endif
#if WINDOW_SIZE >= 51
  LN_OFFSET(0x00000003EE8C1FEA),
#endif
#if WINDOW_SIZE >= 52
  LN_OFFSET(0x00000003F384B555),
#endif
#if WINDOW_SIZE >= 53
  LN_OFFSET(0x00000003F8650D04),
#endif
#if WINDOW_SIZE >= 54
  LN_OFFSET(0x00000003FD2E0EF8),
#endif
#if WINDOW_SIZE >= 55
  LN_OFFSET(0x0000000401E0966E),
#endif
#if WINDOW_SIZE >= 56
  LN_OFFSET(0x00000004067D72CA),
#endif
#if WINDOW_SIZE >= 57
  LN_OFFSET(0x000000040B05686B),
#endif
#if WINDOW_SIZE >= 58
  LN_OFFSET(0x000000040F793171),
#endif
#if WINDOW_SIZE >= 59
  LN_OFFSET(0x0000000413D97E71),
#endif
#if WINDOW_SIZE >= 60
  LN_OFFSET(0x000000041826F719),
#endif
#if WINDOW_SIZE >= 61
  LN_OFFSET(0x000000041C623AC4),
#endif
#if WINDOW_SIZE >= 62
  LN_OFFSET(0x00000004208BE109),
#endif
#if WINDOW_SIZE >= 63
  LN_OFFSET(0x0000000424A47A38),
#endif
#if WINDOW_SIZE >= 64
  LN_OFFSET(0x0000000428AC8FCE),
#endif
#if WINDOW_SIZE >= 65
  LN_OFFSET(0x000000042CA4A4E5),
#endif
#if WINDOW_SIZE >= 66
  LN_OFFSET(0x00000004308D3692),
#endif
#if WINDOW_SIZE >= 67
  LN_OFFSET(0x000000043466BC4A),
#endif
#if WINDOW_SIZE >= 68
  LN_OFFSET(0x000000043831A82E),
#endif
#if WINDOW_SIZE >= 69
  LN_OFFSET(0x000000043BEE6765),
#endif
#if WINDOW_SIZE >= 70
  LN_OFFSET(0x000000043F9D6259),
#endif
#if WINDOW_SIZE >= 71
  LN_OFFSET(0x00000004433EFD09),
#endif
#if WINDOW_SIZE >= 72
  LN_OFFSET(0x0000000446D3973D),
#endif
#if WINDOW_SIZE >= 73
  LN_OFFSET(0x000000044A5B8CC8),
#endif
#if WINDOW_SIZE >= 74
  LN_OFFSET(0x000000044DD735BF),
#endif
#if WINDOW_SIZE >= 75
  LN_OFFSET(0x000000045146E6A8),
#endif
#if WINDOW_SIZE >= 76
  LN_OFFSET(0x0000000454AAF0B0),
#endif
#if WINDOW_SIZE >= 77
  LN_OFFSET(0x000000045803A1D3),
#endif
#if WINDOW_SIZE >= 78
  LN_OFFSET(0x000000045B514508),
#endif
#if WINDOW_SIZE >= 79
  LN_OFFSET(0x000000045E94226B),
#endif
#if WINDOW_SIZE >= 80
  LN_OFFSET(0x0000000461CC7F5E),
#endif
#if WINDOW_SIZE >= 81
  LN_OFFSET(0x0000000464FA9EAB),
#endif
#if WINDOW_SIZE >= 82
  LN_OFFSET(0x00000004681EC0A9),
#endif
#if WINDOW_SIZE >= 83
  LN_OFFSET(0x000000046B392358),
#endif
#if WINDOW_SIZE >= 84
  LN_OFFSET(0x000000046E4A027D),
#endif
#if WINDOW_SIZE >= 85
  LN_OFFSET(0x00000004715197BE),
#endif
#if WINDOW_SIZE >= 86
  LN_OFFSET(0x0000000474501ABA),
#endif
#if WINDOW_SIZE >= 87
  LN_OFFSET(0x000000047745C124),
#endif
#if WINDOW_SIZE >= 88
  LN_OFFSET(0x000000047A32BED7),
#endif
#if WINDOW_SIZE >= 89
  LN_OFFSET(0x000000047D1745EB),
#endif
#if WINDOW_SIZE >= 90
  LN_OFFSET(0x000000047FF386CC),
#endif
#if WINDOW_SIZE >= 91
  LN_OFFSET(0x0000000482C7B049),
#endif
#if WINDOW_SIZE >= 92
  LN_OFFSET(0x000000048593EFA9),
#endif
#if WINDOW_SIZE >= 93
  LN_OFFSET(0x00000004885870BC),
#endif
#if WINDOW_SIZE >= 94
  LN_OFFSET(0x000000048B155DE9),
#endif
#if WINDOW_SIZE >= 95
  LN_OFFSET(0x000000048DCAE03F),
#endif
#if WINDOW_SIZE >= 96
  LN_OFFSET(0x0000000490791F81),
#endif
#if WINDOW_SIZE >= 97
  LN_OFFSET(0x0000000493204239),
#endif
#if WINDOW_SIZE >= 98
  LN_OFFSET(0x0000000495C06DBE),
#endif
#if WINDOW_SIZE >= 99
  LN_OFFSET(0x000000049859C645),
#endif
#if WINDOW_SIZE >= 100
  LN_OFFSET(0x000000049AEC6EED),
#endif
#if WINDOW_SIZE >= 101
  LN_OFFSET(0x000000049D7889C6),
#endif
#if WINDOW_SIZE >= 102
  LN_OFFSET(0x000000049FFE37E1),
#endif
#if WINDOW_SIZE >= 103
  LN_OFFSET(0x00000004A27D9956),
#endif
#if WINDOW_SIZE >= 104
  LN_OFFSET(0x00000004A4F6CD4D),
#endif
#if WINDOW_SIZE >= 105
  LN_OFFSET(0x00000004A769F20C),
#endif
#if WINDOW_SIZE >= 106
  LN_OFFSET(0x00000004A9D724FC),
#endif
#if WINDOW_SIZE >= 107
  LN_OFFSET(0x00000004AC3E82AF),
#endif
#if WINDOW_SIZE >= 108
  LN_OFFSET(0x00000004AEA026F0),
#endif
#if WINDOW_SIZE >= 109
  LN_OFFSET(0x00000004B0FC2CC0),
#endif
#if WINDOW_SIZE >= 110
  LN_OFFSET(0x00000004B352AE66),
#endif
#if WINDOW_SIZE >= 111
  LN_OFFSET(0x00000004B5A3C572),
#endif
#if WINDOW_SIZE >= 112
  LN_OFFSET(0x00000004B7EF8AC2),
#endif
#if WINDOW_SIZE >= 113
  LN_OFFSET(0x00000004BA36168C),
#endif
#if WINDOW_SIZE >= 114
  LN_OFFSET(0x00000004BC778063),
#endif
#if WINDOW_SIZE >= 115
  LN_OFFSET(0x00000004BEB3DF39),
#endif
#if WINDOW_SIZE >= 116
  LN_OFFSET(0x00000004C0EB4969),
#endif
#if WINDOW_SIZE >= 117
  LN_OFFSET(0x00000004C31DD4BB),
#endif
#if WINDOW_SIZE >= 118
  LN_OFFSET(0x00000004C54B9669),
#endif
#if WINDOW_SIZE >= 119
  LN_OFFSET(0x00000004C774A322),
#endif
#if WINDOW_SIZE >= 120
  LN_OFFSET(0x00000004C9990F11),
#endif
#if WINDOW_SIZE >= 121
  LN_OFFSET(0x00000004CBB8EDDF),
#endif
#if WINDOW_SIZE >= 122
  LN_OFFSET(0x00000004CDD452BC),
#endif
#if WINDOW_SIZE >= 123
  LN_OFFSET(0x00000004CFEB505C),
#endif
#if WINDOW_SIZE >= 124
  LN_OFFSET(0x00000004D1FDF901),
#endif
#if WINDOW_SIZE >= 125
  LN_OFFSET(0x00000004D40C5E7C),
#endif
#if WINDOW_SIZE >= 126
  LN_OFFSET(0x00000004D6169230),
#endif
#if WINDOW_SIZE >= 127
  LN_OFFSET(0x00000004D81CA518),
#endif
#if WINDOW_SIZE >= 128
  LN_OFFSET(0x00000004DA1EA7C6),
#endif
#if WINDOW_SIZE >= 129
  LN_OFFSET(0x00000004DC1CAA6D),
#endif
#if WINDOW_SIZE >= 130
  LN_OFFSET(0x00000004DE16BCDC),
#endif
#if WINDOW_SIZE >= 131
  LN_OFFSET(0x00000004E00CEE88),
#endif
#if WINDOW_SIZE >= 132
  LN_OFFSET(0x00000004E1FF4E8A),
#endif
#if WINDOW_SIZE >= 133
  LN_OFFSET(0x00000004E3EDEBA3),
#endif
#if WINDOW_SIZE >= 134
  LN_OFFSET(0x00000004E5D8D441),
#endif
#if WINDOW_SIZE >= 135
  LN_OFFSET(0x00000004E7C0167F),
#endif
#if WINDOW_SIZE >= 136
  LN_OFFSET(0x00000004E9A3C026),
#endif
#if WINDOW_SIZE >= 137
  LN_OFFSET(0x00000004EB83DEB5),
#endif
#if WINDOW_SIZE >= 138
  LN_OFFSET(0x00000004ED607F5C),
#endif
#if WINDOW_SIZE >= 139
  LN_OFFSET(0x00000004EF39AF05),
#endif
#if WINDOW_SIZE >= 140
  LN_OFFSET(0x00000004F10F7A51),
#endif
#if WINDOW_SIZE >= 141
  LN_OFFSET(0x00000004F2E1ED9C),
#endif
#if WINDOW_SIZE >= 142
  LN_OFFSET(0x00000004F4B11501),
#endif
#if WINDOW_SIZE >= 143
  LN_OFFSET(0x00000004F67CFC56),
#endif
#if WINDOW_SIZE >= 144
  LN_OFFSET(0x00000004F845AF34),
#endif
#if WINDOW_SIZE >= 145
  LN_OFFSET(0x00000004FA0B38F8),
#endif
#if WINDOW_SIZE >= 146
  LN_OFFSET(0x00000004FBCDA4C0),
#endif
#if WINDOW_SIZE >= 147
  LN_OFFSET(0x00000004FD8CFD71),
#endif
#if WINDOW_SIZE >= 148
  LN_OFFSET(0x00000004FF494DB6),
#endif
#if WINDOW_SIZE >= 149
  LN_OFFSET(0x000000050102A006),
#endif
#if WINDOW_SIZE >= 150
  LN_OFFSET(0x0000000502B8FEA0),
#endif
#if WINDOW_SIZE >= 151
  LN_OFFSET(0x00000005046C738E),
#endif
#if WINDOW_SIZE >= 152
  LN_OFFSET(0x00000005061D08A8),
#endif
#if WINDOW_SIZE >= 153
  LN_OFFSET(0x0000000507CAC794),
#endif
#if WINDOW_SIZE >= 154
  LN_OFFSET(0x000000050975B9CA),
#endif
#if WINDOW_SIZE >= 155
  LN_OFFSET(0x000000050B1DE890),
#endif
#if WINDOW_SIZE >= 156
  LN_OFFSET(0x000000050CC35D00),
#endif
#if WINDOW_SIZE >= 157
  LN_OFFSET(0x000000050E662006),
#endif
#if WINDOW_SIZE >= 158
  LN_OFFSET(0x0000000510063A63),
#endif
#if WINDOW_SIZE >= 159
  LN_OFFSET(0x0000000511A3B4AF),
#endif
#if WINDOW_SIZE >= 160
  LN_OFFSET(0x00000005133E9755),
#endif
#if WINDOW_SIZE >= 161
  LN_OFFSET(0x0000000514D6EA9D),
#endif
#if WINDOW_SIZE >= 162
  LN_OFFSET(0x00000005166CB6A3),
#endif
#if WINDOW_SIZE >= 163
  LN_OFFSET(0x000000051800035E),
#endif
#if WINDOW_SIZE >= 164
  LN_OFFSET(0x000000051990D8A1),
#endif
#if WINDOW_SIZE >= 165
  LN_OFFSET(0x000000051B1F3E19),
#endif
#if WINDOW_SIZE >= 166
  LN_OFFSET(0x000000051CAB3B50),
#endif
#if WINDOW_SIZE >= 167
  LN_OFFSET(0x000000051E34D7AD),
#endif
#if WINDOW_SIZE >= 168
  LN_OFFSET(0x000000051FBC1A75),
#endif
#if WINDOW_SIZE >= 169
  LN_OFFSET(0x0000000521410ACC),
#endif
#if WINDOW_SIZE >= 170
  LN_OFFSET(0x0000000522C3AFB5),
#endif
#if WINDOW_SIZE >= 171
  LN_OFFSET(0x0000000524441016),
#endif
#if WINDOW_SIZE >= 172
  LN_OFFSET(0x0000000525C232B2),
#endif
#if WINDOW_SIZE >= 173
  LN_OFFSET(0x00000005273E1E31),
#endif
#if WINDOW_SIZE >= 174
  LN_OFFSET(0x0000000528B7D91C),
#endif
#if WINDOW_SIZE >= 175
  LN_OFFSET(0x000000052A2F69E0),
#endif
#if WINDOW_SIZE >= 176
  LN_OFFSET(0x000000052BA4D6CF),
#endif
#if WINDOW_SIZE >= 177
  LN_OFFSET(0x000000052D18261C),
#endif
#if WINDOW_SIZE >= 178
  LN_OFFSET(0x000000052E895DE3),
#endif
#if WINDOW_SIZE >= 179
  LN_OFFSET(0x000000052FF88423),
#endif
#if WINDOW_SIZE >= 180
  LN_OFFSET(0x0000000531659EC4),
#endif
#if WINDOW_SIZE >= 181
  LN_OFFSET(0x0000000532D0B391),
#endif
#if WINDOW_SIZE >= 182
  LN_OFFSET(0x000000053439C841),
#endif
#if WINDOW_SIZE >= 183
  LN_OFFSET(0x0000000535A0E26F),
#endif
#if WINDOW_SIZE >= 184
  LN_OFFSET(0x00000005370607A1),
#endif
#if WINDOW_SIZE >= 185
  LN_OFFSET(0x0000000538693D46),
#endif
#if WINDOW_SIZE >= 186
  LN_OFFSET(0x0000000539CA88B4),
#endif
#if WINDOW_SIZE >= 187
  LN_OFFSET(0x000000053B29EF2F),
#endif
#if WINDOW_SIZE >= 188
  LN_OFFSET(0x000000053C8775E1),
#endif
#if WINDOW_SIZE >= 189
  LN_OFFSET(0x000000053DE321E3),
#endif
#if WINDOW_SIZE >= 190
  LN_OFFSET(0x000000053F3CF837),
#endif
#if WINDOW_SIZE >= 191
  LN_OFFSET(0x000000054094FDCB),
#endif
#if WINDOW_SIZE >= 192
  LN_OFFSET(0x0000000541EB3779),
#endif
#if WINDOW_SIZE >= 193
  LN_OFFSET(0x00000005433FAA0A),
#endif
#if WINDOW_SIZE >= 194
  LN_OFFSET(0x0000000544925A31),
#endif
#if WINDOW_SIZE >= 195
  LN_OFFSET(0x0000000545E34C8F),
#endif
#if WINDOW_SIZE >= 196
  LN_OFFSET(0x00000005473285B5),
#endif
#if WINDOW_SIZE >= 197
  LN_OFFSET(0x0000000548800A21),
#endif
#if WINDOW_SIZE >= 198
  LN_OFFSET(0x0000000549CBDE3D),
#endif
#if WINDOW_SIZE >= 199
  LN_OFFSET(0x000000054B160665),
#endif
#if WINDOW_SIZE >= 200
  LN_OFFSET(0x000000054C5E86E5),
#endif
#if WINDOW_SIZE >= 201
  LN_OFFSET(0x000000054DA563F4),
#endif
#if WINDOW_SIZE >= 202
  LN_OFFSET(0x000000054EEAA1BE),
#endif
#if WINDOW_SIZE >= 203
  LN_OFFSET(0x00000005502E445C),
#endif
#if WINDOW_SIZE >= 204
  LN_OFFSET(0x0000000551704FD9),
#endif
#if WINDOW_SIZE >= 205
  LN_OFFSET(0x0000000552B0C830),
#endif
#if WINDOW_SIZE >= 206
  LN_OFFSET(0x0000000553EFB14E),
#endif
#if WINDOW_SIZE >= 207
  LN_OFFSET(0x00000005552D0F0F),
#endif
#if WINDOW_SIZE >= 208
  LN_OFFSET(0x000000055668E545),
#endif
#if WINDOW_SIZE >= 209
  LN_OFFSET(0x0000000557A337B0),
#endif
#if WINDOW_SIZE >= 210
  LN_OFFSET(0x0000000558DC0A04),
#endif
#if WINDOW_SIZE >= 211
  LN_OFFSET(0x000000055A135FE8),
#endif
#if WINDOW_SIZE >= 212
  LN_OFFSET(0x000000055B493CF3),
#endif
#if WINDOW_SIZE >= 213
  LN_OFFSET(0x000000055C7DA4B4),
#endif
#if WINDOW_SIZE >= 214
  LN_OFFSET(0x000000055DB09AA7),
#endif
#if WINDOW_SIZE >= 215
  LN_OFFSET(0x000000055EE22241),
#endif
#if WINDOW_SIZE >= 216
  LN_OFFSET(0x0000000560123EE7),
#endif
#if WINDOW_SIZE >= 217
  LN_OFFSET(0x000000056140F3F5),
#endif
#if WINDOW_SIZE >= 218
  LN_OFFSET(0x00000005626E44B8),
#endif
#if WINDOW_SIZE >= 219
  LN_OFFSET(0x00000005639A3473),
#endif
#if WINDOW_SIZE >= 220
  LN_OFFSET(0x0000000564C4C65E),
#endif
#if WINDOW_SIZE >= 221
  LN_OFFSET(0x0000000565EDFDA5),
#endif
#if WINDOW_SIZE >= 222
  LN_OFFSET(0x000000056715DD69),
#endif
#if WINDOW_SIZE >= 223
  LN_OFFSET(0x00000005683C68C2),
#endif
#if WINDOW_SIZE >= 224
  LN_OFFSET(0x000000056961A2BA),
#endif
#if WINDOW_SIZE >= 225
  LN_OFFSET(0x000000056A858E53),
#endif
#if WINDOW_SIZE >= 226
  LN_OFFSET(0x000000056BA82E84),
#endif
#if WINDOW_SIZE >= 227
  LN_OFFSET(0x000000056CC9863B),
#endif
#if WINDOW_SIZE >= 228
  LN_OFFSET(0x000000056DE9985B),
#endif
#if WINDOW_SIZE >= 229
  LN_OFFSET(0x000000056F0867BC),
#endif
#if WINDOW_SIZE >= 230
  LN_OFFSET(0x000000057025F730),
#endif
#if WINDOW_SIZE >= 231
  LN_OFFSET(0x000000057142497D),
#endif
#if WINDOW_SIZE >= 232
  LN_OFFSET(0x00000005725D6161),
#endif
#if WINDOW_SIZE >= 233
  LN_OFFSET(0x000000057377418F),
#endif
#if WINDOW_SIZE >= 234
  LN_OFFSET(0x00000005748FECB3),
#endif
#if WINDOW_SIZE >= 235
  LN_OFFSET(0x0000000575A76570),
#endif
#if WINDOW_SIZE >= 236
  LN_OFFSET(0x0000000576BDAE61),
#endif
#if WINDOW_SIZE >= 237
  LN_OFFSET(0x0000000577D2CA16),
#endif
#if WINDOW_SIZE >= 238
  LN_OFFSET(0x0000000578E6BB1A),
#endif
#if WINDOW_SIZE >= 239
  LN_OFFSET(0x0000000579F983ED),
#endif
#if WINDOW_SIZE >= 240
  LN_OFFSET(0x000000057B0B2708),
#endif
#if WINDOW_SIZE >= 241
  LN_OFFSET(0x000000057C1BA6DE),
#endif
#if WINDOW_SIZE >= 242
  LN_OFFSET(0x000000057D2B05D7),
#endif
#if WINDOW_SIZE >= 243
  LN_OFFSET(0x000000057E394656),
#endif
#if WINDOW_SIZE >= 244
  LN_OFFSET(0x000000057F466AB4),
#endif
#if WINDOW_SIZE >= 245
  LN_OFFSET(0x0000000580527545),
#endif
#if WINDOW_SIZE >= 246
  LN_OFFSET(0x00000005815D6854),
#endif
#if WINDOW_SIZE >= 247
  LN_OFFSET(0x0000000582674626),
#endif
#if WINDOW_SIZE >= 248
  LN_OFFSET(0x00000005837010F9),
#endif
#if WINDOW_SIZE >= 249
  LN_OFFSET(0x000000058477CB03),
#endif
#if WINDOW_SIZE >= 250
  LN_OFFSET(0x00000005857E7674),
#endif
#if WINDOW_SIZE >= 251
  LN_OFFSET(0x0000000586841575),
#endif
#if WINDOW_SIZE >= 252
  LN_OFFSET(0x000000058788AA28),
#endif
#if WINDOW_SIZE >= 253
  LN_OFFSET(0x00000005888C36AA),
#endif
#if WINDOW_SIZE >= 254
  LN_OFFSET(0x00000005898EBD0F),
#endif
#if WINDOW_SIZE >= 255
  LN_OFFSET(0x000000058A903F68),
#endif
#if WINDOW_SIZE >= 256
  LN_OFFSET(0x000000058B90BFBE),
#endif
#if WINDOW_SIZE >= 257
  LN_OFFSET(0x000000058C904013),
#endif
#if WINDOW_SIZE >= 258
  LN_OFFSET(0x000000058D8EC265),
#endif
#if WINDOW_SIZE >= 259
  LN_OFFSET(0x000000058E8C48AA),
#endif
#if WINDOW_SIZE >= 260
  LN_OFFSET(0x000000058F88D4D4),
#endif
#if WINDOW_SIZE >= 261
  LN_OFFSET(0x00000005908468CF),
#endif
#if WINDOW_SIZE >= 262
  LN_OFFSET(0x00000005917F0680),
#endif
#if WINDOW_SIZE >= 263
  LN_OFFSET(0x000000059278AFC8),
#endif
#if WINDOW_SIZE >= 264
  LN_OFFSET(0x0000000593716682),
#endif
#if WINDOW_SIZE >= 265
  LN_OFFSET(0x0000000594692C83),
#endif
#if WINDOW_SIZE >= 266
  LN_OFFSET(0x000000059560039B),
#endif
#if WINDOW_SIZE >= 267
  LN_OFFSET(0x000000059655ED96),
#endif
#if WINDOW_SIZE >= 268
  LN_OFFSET(0x00000005974AEC39),
#endif
#if WINDOW_SIZE >= 269
  LN_OFFSET(0x00000005983F0145),
#endif
#if WINDOW_SIZE >= 270
  LN_OFFSET(0x0000000599322E77),
#endif
#if WINDOW_SIZE >= 271
  LN_OFFSET(0x000000059A247583),
#endif
#if WINDOW_SIZE >= 272
  LN_OFFSET(0x000000059B15D81E),
#endif
#if WINDOW_SIZE >= 273
  LN_OFFSET(0x000000059C0657F4),
#endif
#if WINDOW_SIZE >= 274
  LN_OFFSET(0x000000059CF5F6AD),
#endif
#if WINDOW_SIZE >= 275
  LN_OFFSET(0x000000059DE4B5ED),
#endif
#if WINDOW_SIZE >= 276
  LN_OFFSET(0x000000059ED29754),
#endif
#if WINDOW_SIZE >= 277
  LN_OFFSET(0x000000059FBF9C7D),
#endif
#if WINDOW_SIZE >= 278
  LN_OFFSET(0x00000005A0ABC6FD),
#endif
#if WINDOW_SIZE >= 279
  LN_OFFSET(0x00000005A1971867),
#endif
#if WINDOW_SIZE >= 280
  LN_OFFSET(0x00000005A2819249),
#endif
#if WINDOW_SIZE >= 281
  LN_OFFSET(0x00000005A36B362C),
#endif
#if WINDOW_SIZE >= 282
  LN_OFFSET(0x00000005A4540594),
#endif
#if WINDOW_SIZE >= 283
  LN_OFFSET(0x00000005A53C0204),
#endif
#if WINDOW_SIZE >= 284
  LN_OFFSET(0x00000005A6232CF8),
#endif
#if WINDOW_SIZE >= 285
  LN_OFFSET(0x00000005A70987EA),
#endif
#if WINDOW_SIZE >= 286
  LN_OFFSET(0x00000005A7EF144D),
#endif
#if WINDOW_SIZE >= 287
  LN_OFFSET(0x00000005A8D3D394),
#endif
#if WINDOW_SIZE >= 288
  LN_OFFSET(0x00000005A9B7C72C),
#endif
#if WINDOW_SIZE >= 289
  LN_OFFSET(0x00000005AA9AF07E),
#endif
#if WINDOW_SIZE >= 290
  LN_OFFSET(0x00000005AB7D50F0),
#endif
#if WINDOW_SIZE >= 291
  LN_OFFSET(0x00000005AC5EE9E4),
#endif
#if WINDOW_SIZE >= 292
  LN_OFFSET(0x00000005AD3FBCB8),
#endif
#if WINDOW_SIZE >= 293
  LN_OFFSET(0x00000005AE1FCAC7),
#endif
#if WINDOW_SIZE >= 294
  LN_OFFSET(0x00000005AEFF1568),
#endif
#if WINDOW_SIZE >= 295
  LN_OFFSET(0x00000005AFDD9DF0),
#endif
#if WINDOW_SIZE >= 296
  LN_OFFSET(0x00000005B0BB65AE),
#endif
#if WINDOW_SIZE >= 297
  LN_OFFSET(0x00000005B1986DF0),
#endif
#if WINDOW_SIZE >= 298
  LN_OFFSET(0x00000005B274B7FE),
#endif
#if WINDOW_SIZE >= 299
  LN_OFFSET(0x00000005B3504520),
#endif
#if WINDOW_SIZE >= 300
  LN_OFFSET(0x00000005B42B1698),
#endif
#if WINDOW_SIZE >= 301
  LN_OFFSET(0x00000005B5052DA5),
#endif
#if WINDOW_SIZE >= 302
  LN_OFFSET(0x00000005B5DE8B85),
#endif
#if WINDOW_SIZE >= 303
  LN_OFFSET(0x00000005B6B73171),
#endif
#if WINDOW_SIZE >= 304
  LN_OFFSET(0x00000005B78F209F),
#endif
#if WINDOW_SIZE >= 305
  LN_OFFSET(0x00000005B8665A43),
#endif
#if WINDOW_SIZE >= 306
  LN_OFFSET(0x00000005B93CDF8C),
#endif
#if WINDOW_SIZE >= 307
  LN_OFFSET(0x00000005BA12B1A9),
#endif
#if WINDOW_SIZE >= 308
  LN_OFFSET(0x00000005BAE7D1C2),
#endif
#if WINDOW_SIZE >= 309
  LN_OFFSET(0x00000005BBBC4101),
#endif
#if WINDOW_SIZE >= 310
  LN_OFFSET(0x00000005BC900088),
#endif
#if WINDOW_SIZE >= 311
  LN_OFFSET(0x00000005BD63117B),
#endif
#if WINDOW_SIZE >= 312
  LN_OFFSET(0x00000005BE3574F8),
#endif
#if WINDOW_SIZE >= 313
  LN_OFFSET(0x00000005BF072C1B),
#endif
#if WINDOW_SIZE >= 314
  LN_OFFSET(0x00000005BFD837FE),
#endif
#if WINDOW_SIZE >= 315
  LN_OFFSET(0x00000005C0A899B7),
#endif
#if WINDOW_SIZE >= 316
  LN_OFFSET(0x00000005C178525B),
#endif
#if WINDOW_SIZE >= 317
  LN_OFFSET(0x00000005C24762FB),
#endif
#if WINDOW_SIZE >= 318
  LN_OFFSET(0x00000005C315CCA6),
#endif
#if WINDOW_SIZE >= 319
  LN_OFFSET(0x00000005C3E39069),
#endif
#if WINDOW_SIZE >= 320
  LN_OFFSET(0x00000005C4B0AF4D),
#endif
#if WINDOW_SIZE >= 321
  LN_OFFSET(0x00000005C57D2A5A),
#endif
#if WINDOW_SIZE >= 322
  LN_OFFSET(0x00000005C6490295),
#endif
#if WINDOW_SIZE >= 323
  LN_OFFSET(0x00000005C71438FF),
#endif
#if WINDOW_SIZE >= 324
  LN_OFFSET(0x00000005C7DECE9A),
#endif
#if WINDOW_SIZE >= 325
  LN_OFFSET(0x00000005C8A8C463),
#endif
#if WINDOW_SIZE >= 326
  LN_OFFSET(0x00000005C9721B56),
#endif
#if WINDOW_SIZE >= 327
  LN_OFFSET(0x00000005CA3AD46B),
#endif
#if WINDOW_SIZE >= 328
  LN_OFFSET(0x00000005CB02F099),
#endif
#if WINDOW_SIZE >= 329
  LN_OFFSET(0x00000005CBCA70D5),
#endif
#if WINDOW_SIZE >= 330
  LN_OFFSET(0x00000005CC915611),
#endif
#if WINDOW_SIZE >= 331
  LN_OFFSET(0x00000005CD57A13D),
#endif
#if WINDOW_SIZE >= 332
  LN_OFFSET(0x00000005CE1D5348),
#endif
#if WINDOW_SIZE >= 333
  LN_OFFSET(0x00000005CEE26D1C),
#endif
#if WINDOW_SIZE >= 334
  LN_OFFSET(0x00000005CFA6EFA5),
#endif
#if WINDOW_SIZE >= 335
  LN_OFFSET(0x00000005D06ADBC8),
#endif
#if WINDOW_SIZE >= 336
  LN_OFFSET(0x00000005D12E326D),
#endif
#if WINDOW_SIZE >= 337
  LN_OFFSET(0x00000005D1F0F475),
#endif
#if WINDOW_SIZE >= 338
  LN_OFFSET(0x00000005D2B322C4),
#endif
#if WINDOW_SIZE >= 339
  LN_OFFSET(0x00000005D374BE37),
#endif
#if WINDOW_SIZE >= 340
  LN_OFFSET(0x00000005D435C7AD),
#endif
#if WINDOW_SIZE >= 341
  LN_OFFSET(0x00000005D4F64002),
#endif
#if WINDOW_SIZE >= 342
  LN_OFFSET(0x00000005D5B6280E),
#endif
#if WINDOW_SIZE >= 343
  LN_OFFSET(0x00000005D67580A9),
#endif
#if WINDOW_SIZE >= 344
  LN_OFFSET(0x00000005D7344AAA),
#endif
#if WINDOW_SIZE >= 345
  LN_OFFSET(0x00000005D7F286E3),
#endif
#if WINDOW_SIZE >= 346
  LN_OFFSET(0x00000005D8B03628),
#endif
#if WINDOW_SIZE >= 347
  LN_OFFSET(0x00000005D96D5949),
#endif
#if WINDOW_SIZE >= 348
  LN_OFFSET(0x00000005DA29F114),
#endif
#if WINDOW_SIZE >= 349
  LN_OFFSET(0x00000005DAE5FE55),
#endif
#if WINDOW_SIZE >= 350
  LN_OFFSET(0x00000005DBA181D8),
#endif
#if WINDOW_SIZE >= 351
  LN_OFFSET(0x00000005DC5C7C66),
#endif
#if WINDOW_SIZE >= 352
  LN_OFFSET(0x00000005DD16EEC6),
#endif
#if WINDOW_SIZE >= 353
  LN_OFFSET(0x00000005DDD0D9BF),
#endif
#if WINDOW_SIZE >= 354
  LN_OFFSET(0x00000005DE8A3E14),
#endif
#if WINDOW_SIZE >= 355
  LN_OFFSET(0x00000005DF431C88),
#endif
#if WINDOW_SIZE >= 356
  LN_OFFSET(0x00000005DFFB75DB),
#endif
#if WINDOW_SIZE >= 357
  LN_OFFSET(0x00000005E0B34ACD),
#endif
#if WINDOW_SIZE >= 358
  LN_OFFSET(0x00000005E16A9C1B),
#endif
#if WINDOW_SIZE >= 359
  LN_OFFSET(0x00000005E2216A82),
#endif
#if WINDOW_SIZE >= 360
  LN_OFFSET(0x00000005E2D7B6BB),
#endif
#if WINDOW_SIZE >= 361
  LN_OFFSET(0x00000005E38D8181),
#endif
#if WINDOW_SIZE >= 362
  LN_OFFSET(0x00000005E442CB89),
#endif
#if WINDOW_SIZE >= 363
  LN_OFFSET(0x00000005E4F7958A),
#endif
#if WINDOW_SIZE >= 364
  LN_OFFSET(0x00000005E5ABE038),
#endif
#if WINDOW_SIZE >= 365
  LN_OFFSET(0x00000005E65FAC47),
#endif
#if WINDOW_SIZE >= 366
  LN_OFFSET(0x00000005E712FA67),
#endif
#if WINDOW_SIZE >= 367
  LN_OFFSET(0x00000005E7C5CB48),
#endif
#if WINDOW_SIZE >= 368
  LN_OFFSET(0x00000005E8781F99),
#endif
#if WINDOW_SIZE >= 369
  LN_OFFSET(0x00000005E929F807),
#endif
#if WINDOW_SIZE >= 370
  LN_OFFSET(0x00000005E9DB553E),
#endif
#if WINDOW_SIZE >= 371
  LN_OFFSET(0x00000005EA8C37E7),
#endif
#if WINDOW_SIZE >= 372
  LN_OFFSET(0x00000005EB3CA0AC),
#endif
#if WINDOW_SIZE >= 373
  LN_OFFSET(0x00000005EBEC9035),
#endif
#if WINDOW_SIZE >= 374
  LN_OFFSET(0x00000005EC9C0727),
#endif
#if WINDOW_SIZE >= 375
  LN_OFFSET(0x00000005ED4B0627),
#endif
#if WINDOW_SIZE >= 376
  LN_OFFSET(0x00000005EDF98DD9),
#endif
#if WINDOW_SIZE >= 377
  LN_OFFSET(0x00000005EEA79EDF),
#endif
#if WINDOW_SIZE >= 378
  LN_OFFSET(0x00000005EF5539DB),
#endif
#if WINDOW_SIZE >= 379
  LN_OFFSET(0x00000005F0025F6B),
#endif
#if WINDOW_SIZE >= 380
  LN_OFFSET(0x00000005F0AF102F),
#endif
#if WINDOW_SIZE >= 381
  LN_OFFSET(0x00000005F15B4CC2),
#endif
#if WINDOW_SIZE >= 382
  LN_OFFSET(0x00000005F20715C2),
#endif
#if WINDOW_SIZE >= 383
  LN_OFFSET(0x00000005F2B26BC9),
#endif
#if WINDOW_SIZE >= 384
  LN_OFFSET(0x00000005F35D4F71),
#endif
#if WINDOW_SIZE >= 385
  LN_OFFSET(0x00000005F407C151),
#endif
#if WINDOW_SIZE >= 386
  LN_OFFSET(0x00000005F4B1C202),
#endif
#if WINDOW_SIZE >= 387
  LN_OFFSET(0x00000005F55B5218),
#endif
#if WINDOW_SIZE >= 388
  LN_OFFSET(0x00000005F6047228),
#endif
#if WINDOW_SIZE >= 389
  LN_OFFSET(0x00000005F6AD22C7),
#endif
#if WINDOW_SIZE >= 390
  LN_OFFSET(0x00000005F7556487),
#endif
#if WINDOW_SIZE >= 391
  LN_OFFSET(0x00000005F7FD37F9),
#endif
#if WINDOW_SIZE >= 392
  LN_OFFSET(0x00000005F8A49DAD),
#endif
#if WINDOW_SIZE >= 393
  LN_OFFSET(0x00000005F94B9633),
#endif
#if WINDOW_SIZE >= 394
  LN_OFFSET(0x00000005F9F22218),
#endif
#if WINDOW_SIZE >= 395
  LN_OFFSET(0x00000005FA9841EA),
#endif
#if WINDOW_SIZE >= 396
  LN_OFFSET(0x00000005FB3DF635),
#endif
#if WINDOW_SIZE >= 397
  LN_OFFSET(0x00000005FBE33F82),
#endif
#if WINDOW_SIZE >= 398
  LN_OFFSET(0x00000005FC881E5D),
#endif
#if WINDOW_SIZE >= 399
  LN_OFFSET(0x00000005FD2C934E),
#endif
#if WINDOW_SIZE >= 400
  LN_OFFSET(0x00000005FDD09EDC),
#endif
#if WINDOW_SIZE >= 401
  LN_OFFSET(0x00000005FE74418F),
#endif
#if WINDOW_SIZE >= 402
  LN_OFFSET(0x00000005FF177BEC),
#endif
#if WINDOW_SIZE >= 403
  LN_OFFSET(0x00000005FFBA4E78),
#endif
#if WINDOW_SIZE >= 404
  LN_OFFSET(0x00000006005CB9B6),
#endif
#if WINDOW_SIZE >= 405
  LN_OFFSET(0x0000000600FEBE2A),
#endif
#if WINDOW_SIZE >= 406
  LN_OFFSET(0x0000000601A05C54),
#endif
#if WINDOW_SIZE >= 407
  LN_OFFSET(0x00000006024194B7),
#endif
#if WINDOW_SIZE >= 408
  LN_OFFSET(0x0000000602E267D1),
#endif
#if WINDOW_SIZE >= 409
  LN_OFFSET(0x000000060382D622),
#endif
#if WINDOW_SIZE >= 410
  LN_OFFSET(0x000000060422E028),
#endif
#if WINDOW_SIZE >= 411
  LN_OFFSET(0x0000000604C28660),
#endif
#if WINDOW_SIZE >= 412
  LN_OFFSET(0x000000060561C945),
#endif
#if WINDOW_SIZE >= 413
  LN_OFFSET(0x000000060600A954),
#endif
#if WINDOW_SIZE >= 414
  LN_OFFSET(0x00000006069F2707),
#endif
#if WINDOW_SIZE >= 415
  LN_OFFSET(0x00000006073D42D7),
#endif
#if WINDOW_SIZE >= 416
  LN_OFFSET(0x0000000607DAFD3D),
#endif
#if WINDOW_SIZE >= 417
  LN_OFFSET(0x00000006087856B0),
#endif
#if WINDOW_SIZE >= 418
  LN_OFFSET(0x0000000609154FA8),
#endif
#if WINDOW_SIZE >= 419
  LN_OFFSET(0x0000000609B1E89A),
#endif
#if WINDOW_SIZE >= 420
  LN_OFFSET(0x000000060A4E21FC),
#endif
#if WINDOW_SIZE >= 421
  LN_OFFSET(0x000000060AE9FC42),
#endif
#if WINDOW_SIZE >= 422
  LN_OFFSET(0x000000060B8577DF),
#endif
#if WINDOW_SIZE >= 423
  LN_OFFSET(0x000000060C209547),
#endif
#if WINDOW_SIZE >= 424
  LN_OFFSET(0x000000060CBB54EB),
#endif
#if WINDOW_SIZE >= 425
  LN_OFFSET(0x000000060D55B73D),
#endif
#if WINDOW_SIZE >= 426
  LN_OFFSET(0x000000060DEFBCAB),
#endif
#if WINDOW_SIZE >= 427
  LN_OFFSET(0x000000060E8965A7),
#endif
#if WINDOW_SIZE >= 428
  LN_OFFSET(0x000000060F22B29F),
#endif
#if WINDOW_SIZE >= 429
  LN_OFFSET(0x000000060FBBA400),
#endif
#if WINDOW_SIZE >= 430
  LN_OFFSET(0x0000000610543A39),
#endif
#if WINDOW_SIZE >= 431
  LN_OFFSET(0x0000000610EC75B4),
#endif
#if WINDOW_SIZE >= 432
  LN_OFFSET(0x00000006118456DF),
#endif
#if WINDOW_SIZE >= 433
  LN_OFFSET(0x00000006121BDE24),
#endif
#if WINDOW_SIZE >= 434
  LN_OFFSET(0x0000000612B30BED),
#endif
#if WINDOW_SIZE >= 435
  LN_OFFSET(0x000000061349E0A3),
#endif
#if WINDOW_SIZE >= 436
  LN_OFFSET(0x0000000613E05CAF),
#endif
#if WINDOW_SIZE >= 437
  LN_OFFSET(0x000000061476807A),
#endif
#if WINDOW_SIZE >= 438
  LN_OFFSET(0x00000006150C4C6B),
#endif
#if WINDOW_SIZE >= 439
  LN_OFFSET(0x0000000615A1C0E7),
#endif
#if WINDOW_SIZE >= 440
  LN_OFFSET(0x000000061636DE56),
#endif
#if WINDOW_SIZE >= 441
  LN_OFFSET(0x0000000616CBA51B),
#endif
#if WINDOW_SIZE >= 442
  LN_OFFSET(0x000000061760159D),
#endif
#if WINDOW_SIZE >= 443
  LN_OFFSET(0x0000000617F4303E),
#endif
#if WINDOW_SIZE >= 444
  LN_OFFSET(0x000000061887F561),
#endif
#if WINDOW_SIZE >= 445
  LN_OFFSET(0x00000006191B656A),
#endif
#if WINDOW_SIZE >= 446
  LN_OFFSET(0x0000000619AE80BA),
#endif
#if WINDOW_SIZE >= 447
  LN_OFFSET(0x000000061A4147B1),
#endif
#if WINDOW_SIZE >= 448
  LN_OFFSET(0x000000061AD3BAB2),
#endif
#if WINDOW_SIZE >= 449
  LN_OFFSET(0x000000061B65DA1A),
#endif
#if WINDOW_SIZE >= 450
  LN_OFFSET(0x000000061BF7A64B),
#endif
#if WINDOW_SIZE >= 451
  LN_OFFSET(0x000000061C891FA1),
#endif
#if WINDOW_SIZE >= 452
  LN_OFFSET(0x000000061D1A467C),
#endif
#if WINDOW_SIZE >= 453
  LN_OFFSET(0x000000061DAB1B38),
#endif
#if WINDOW_SIZE >= 454
  LN_OFFSET(0x000000061E3B9E33),
#endif
#if WINDOW_SIZE >= 455
  LN_OFFSET(0x000000061ECBCFC8),
#endif
#if WINDOW_SIZE >= 456
  LN_OFFSET(0x000000061F5BB052),
#endif
#if WINDOW_SIZE >= 457
  LN_OFFSET(0x000000061FEB402E),
#endif
#if WINDOW_SIZE >= 458
  LN_OFFSET(0x00000006207A7FB4),
#endif
#if WINDOW_SIZE >= 459
  LN_OFFSET(0x0000000621096F3F),
#endif
#if WINDOW_SIZE >= 460
  LN_OFFSET(0x0000000621980F28),
#endif
#if WINDOW_SIZE >= 461
  LN_OFFSET(0x0000000622265FC8),
#endif
#if WINDOW_SIZE >= 462
  LN_OFFSET(0x0000000622B46175),
#endif
#if WINDOW_SIZE >= 463
  LN_OFFSET(0x0000000623421489),
#endif
#if WINDOW_SIZE >= 464
  LN_OFFSET(0x0000000623CF7959),
#endif
#if WINDOW_SIZE >= 465
  LN_OFFSET(0x00000006245C903B),
#endif
#if WINDOW_SIZE >= 466
  LN_OFFSET(0x0000000624E95987),
#endif
#if WINDOW_SIZE >= 467
  LN_OFFSET(0x000000062575D590),
#endif
#if WINDOW_SIZE >= 468
  LN_OFFSET(0x00000006260204AB),
#endif
#if WINDOW_SIZE >= 469
  LN_OFFSET(0x00000006268DE72D),
#endif
#if WINDOW_SIZE >= 470
  LN_OFFSET(0x0000000627197D68),
#endif
#if WINDOW_SIZE >= 471
  LN_OFFSET(0x0000000627A4C7B1),
#endif
#if WINDOW_SIZE >= 472
  LN_OFFSET(0x00000006282FC659),
#endif
#if WINDOW_SIZE >= 473
  LN_OFFSET(0x0000000628BA79B2),
#endif
#if WINDOW_SIZE >= 474
  LN_OFFSET(0x000000062944E20E),
#endif
#if WINDOW_SIZE >= 475
  LN_OFFSET(0x0000000629CEFFBE),
#endif
#if WINDOW_SIZE >= 476
  LN_OFFSET(0x000000062A58D312),
#endif
#if WINDOW_SIZE >= 477
  LN_OFFSET(0x000000062AE25C59),
#endif
#if WINDOW_SIZE >= 478
  LN_OFFSET(0x000000062B6B9BE5),
#endif
#if WINDOW_SIZE >= 479
  LN_OFFSET(0x000000062BF49202),
#endif
#if WINDOW_SIZE >= 480
  LN_OFFSET(0x000000062C7D3F00),
#endif
#if WINDOW_SIZE >= 481
  LN_OFFSET(0x000000062D05A32D),
#endif
#if WINDOW_SIZE >= 482
  LN_OFFSET(0x000000062D8DBED6),
#endif
#if WINDOW_SIZE >= 483
  LN_OFFSET(0x000000062E159248),
#endif
#if WINDOW_SIZE >= 484
  LN_OFFSET(0x000000062E9D1DCF),
#endif
#if WINDOW_SIZE >= 485
  LN_OFFSET(0x000000062F2461B8),
#endif
#if WINDOW_SIZE >= 486
  LN_OFFSET(0x000000062FAB5E4D),
#endif
#if WINDOW_SIZE >= 487
  LN_OFFSET(0x00000006303213DB),
#endif
#if WINDOW_SIZE >= 488
  LN_OFFSET(0x0000000630B882AC),
#endif
#if WINDOW_SIZE >= 489
  LN_OFFSET(0x00000006313EAB09),
#endif
#if WINDOW_SIZE >= 490
  LN_OFFSET(0x0000000631C48D3C),
#endif
#if WINDOW_SIZE >= 491
  LN_OFFSET(0x00000006324A2990),
#endif
#if WINDOW_SIZE >= 492
  LN_OFFSET(0x0000000632CF804C),
#endif
#if WINDOW_SIZE >= 493
  LN_OFFSET(0x00000006335491B9),
#endif
#if WINDOW_SIZE >= 494
  LN_OFFSET(0x0000000633D95E1E),
#endif
#if WINDOW_SIZE >= 495
  LN_OFFSET(0x00000006345DE5C4),
#endif
#if WINDOW_SIZE >= 496
  LN_OFFSET(0x0000000634E228F1),
#endif
#if WINDOW_SIZE >= 497
  LN_OFFSET(0x00000006356627EC),
#endif
#if WINDOW_SIZE >= 498
  LN_OFFSET(0x0000000635E9E2FB),
#endif
#if WINDOW_SIZE >= 499
  LN_OFFSET(0x00000006366D5A64),
#endif
#if WINDOW_SIZE >= 500
  LN_OFFSET(0x0000000636F08E6C),
#endif
#if WINDOW_SIZE >= 501
  LN_OFFSET(0x0000000637737F58),
#endif
#if WINDOW_SIZE >= 502
  LN_OFFSET(0x0000000637F62D6C),
#endif
#if WINDOW_SIZE >= 503
  LN_OFFSET(0x00000006387898EE),
#endif
#if WINDOW_SIZE >= 504
  LN_OFFSET(0x0000000638FAC220),
#endif
#if WINDOW_SIZE >= 505
  LN_OFFSET(0x00000006397CA945),
#endif
#if WINDOW_SIZE >= 506
  LN_OFFSET(0x0000000639FE4EA1),
#endif
#if WINDOW_SIZE >= 507
  LN_OFFSET(0x000000063A7FB277),
#endif
#if WINDOW_SIZE >= 508
  LN_OFFSET(0x000000063B00D507),
#endif
#if WINDOW_SIZE >= 509
  LN_OFFSET(0x000000063B81B695),
#endif
#if WINDOW_SIZE >= 510
  LN_OFFSET(0x000000063C025760),
#endif
#if WINDOW_SIZE >= 511
  LN_OFFSET(0x000000063C82B7AB),
#endif
#if WINDOW_SIZE >= 512
  LN_OFFSET(0x000000063D02D7B6),
#endif
#if WINDOW_SIZE >= 513
  LN_OFFSET(0x000000063D82B7C1),
#endif
#if WINDOW_SIZE >= 514
  LN_OFFSET(0x000000063E02580B),
#endif
#if WINDOW_SIZE >= 515
  LN_OFFSET(0x000000063E81B8D5),
#endif
#if WINDOW_SIZE >= 516
  LN_OFFSET(0x000000063F00DA5D),
#endif
#if WINDOW_SIZE >= 517
  LN_OFFSET(0x000000063F7FBCE2),
#endif
#if WINDOW_SIZE >= 518
  LN_OFFSET(0x000000063FFE60A2),
#endif
#if WINDOW_SIZE >= 519
  LN_OFFSET(0x00000006407CC5DB),
#endif
#if WINDOW_SIZE >= 520
  LN_OFFSET(0x0000000640FAECCC),
#endif
#if WINDOW_SIZE >= 521
  LN_OFFSET(0x000000064178D5B1),
#endif
#if WINDOW_SIZE >= 522
  LN_OFFSET(0x0000000641F680C7),
#endif
#if WINDOW_SIZE >= 523
  LN_OFFSET(0x000000064273EE4A),
#endif
#if WINDOW_SIZE >= 524
  LN_OFFSET(0x0000000642F11E78),
#endif
#if WINDOW_SIZE >= 525
  LN_OFFSET(0x00000006436E118B),
#endif
#if WINDOW_SIZE >= 526
  LN_OFFSET(0x0000000643EAC7C0),
#endif
#if WINDOW_SIZE >= 527
  LN_OFFSET(0x0000000644674151),
#endif
#if WINDOW_SIZE >= 528
  LN_OFFSET(0x0000000644E37E79),
#endif
#if WINDOW_SIZE >= 529
  LN_OFFSET(0x00000006455F7F74),
#endif
#if WINDOW_SIZE >= 530
  LN_OFFSET(0x0000000645DB447A),
#endif
#if WINDOW_SIZE >= 531
  LN_OFFSET(0x000000064656CDC7),
#endif
#if WINDOW_SIZE >= 532
  LN_OFFSET(0x0000000646D21B93),
#endif
#if WINDOW_SIZE >= 533
  LN_OFFSET(0x00000006474D2E18),
#endif
#if WINDOW_SIZE >= 534
  LN_OFFSET(0x0000000647C8058E),
#endif
#if WINDOW_SIZE >= 535
  LN_OFFSET(0x000000064842A22E),
#endif
#if WINDOW_SIZE >= 536
  LN_OFFSET(0x0000000648BD0431),
#endif
#if WINDOW_SIZE >= 537
  LN_OFFSET(0x0000000649372BCE),
#endif
#if WINDOW_SIZE >= 538
  LN_OFFSET(0x0000000649B1193D),
#endif
#if WINDOW_SIZE >= 539
  LN_OFFSET(0x000000064A2ACCB6),
#endif
#if WINDOW_SIZE >= 540
  LN_OFFSET(0x000000064AA4466E),
#endif
#if WINDOW_SIZE >= 541
  LN_OFFSET(0x000000064B1D869E),
#endif
#if WINDOW_SIZE >= 542
  LN_OFFSET(0x000000064B968D7B),
#endif
#if WINDOW_SIZE >= 543
  LN_OFFSET(0x000000064C0F5B3C),
#endif
#if WINDOW_SIZE >= 544
  LN_OFFSET(0x000000064C87F016),
#endif
#if WINDOW_SIZE >= 545
  LN_OFFSET(0x000000064D004C3F),
#endif
#if WINDOW_SIZE >= 546
  LN_OFFSET(0x000000064D786FEB),
#endif
#if WINDOW_SIZE >= 547
  LN_OFFSET(0x000000064DF05B51),
#endif
#if WINDOW_SIZE >= 548
  LN_OFFSET(0x000000064E680EA5),
#endif
#if WINDOW_SIZE >= 549
  LN_OFFSET(0x000000064EDF8A1A),
#endif
#if WINDOW_SIZE >= 550
  LN_OFFSET(0x000000064F56CDE5),
#endif
#if WINDOW_SIZE >= 551
  LN_OFFSET(0x000000064FCDDA3A),
#endif
#if WINDOW_SIZE >= 552
  LN_OFFSET(0x000000065044AF4C),
#endif
#if WINDOW_SIZE >= 553
  LN_OFFSET(0x0000000650BB4D4F),
#endif
#if WINDOW_SIZE >= 554
  LN_OFFSET(0x000000065131B475),
#endif
#if WINDOW_SIZE >= 555
  LN_OFFSET(0x0000000651A7E4F1),
#endif
#if WINDOW_SIZE >= 556
  LN_OFFSET(0x00000006521DDEF5),
#endif
#if WINDOW_SIZE >= 557
  LN_OFFSET(0x000000065293A2B4),
#endif
#if WINDOW_SIZE >= 558
  LN_OFFSET(0x000000065309305F),
#endif
#if WINDOW_SIZE >= 559
  LN_OFFSET(0x00000006537E8828),
#endif
#if WINDOW_SIZE >= 560
  LN_OFFSET(0x0000000653F3AA41),
#endif
#if WINDOW_SIZE >= 561
  LN_OFFSET(0x00000006546896DA),
#endif
#if WINDOW_SIZE >= 562
  LN_OFFSET(0x0000000654DD4E23),
#endif
#if WINDOW_SIZE >= 563
  LN_OFFSET(0x000000065551D04F),
#endif
#if WINDOW_SIZE >= 564
  LN_OFFSET(0x0000000655C61D8C),
#endif
#if WINDOW_SIZE >= 565
  LN_OFFSET(0x00000006563A360B),
#endif
#if WINDOW_SIZE >= 566
  LN_OFFSET(0x0000000656AE19FC),
#endif
#if WINDOW_SIZE >= 567
  LN_OFFSET(0x000000065721C98E),
#endif
#if WINDOW_SIZE >= 568
  LN_OFFSET(0x00000006579544F0),
#endif
#if WINDOW_SIZE >= 569
  LN_OFFSET(0x0000000658088C52),
#endif
#if WINDOW_SIZE >= 570
  LN_OFFSET(0x00000006587B9FE2),
#endif
#if WINDOW_SIZE >= 571
  LN_OFFSET(0x0000000658EE7FCE),
#endif
#if WINDOW_SIZE >= 572
  LN_OFFSET(0x0000000659612C45),
#endif
#if WINDOW_SIZE >= 573
  LN_OFFSET(0x0000000659D3A575),
#endif
#if WINDOW_SIZE >= 574
  LN_OFFSET(0x000000065A45EB8C),
#endif
#if WINDOW_SIZE >= 575
  LN_OFFSET(0x000000065AB7FEB7),
#endif
#if WINDOW_SIZE >= 576
  LN_OFFSET(0x000000065B29DF24),
#endif
#if WINDOW_SIZE >= 577
  LN_OFFSET(0x000000065B9B8CFF),
#endif
#if WINDOW_SIZE >= 578
  LN_OFFSET(0x000000065C0D0876),
#endif
#if WINDOW_SIZE >= 579
  LN_OFFSET(0x000000065C7E51B5),
#endif
#if WINDOW_SIZE >= 580
  LN_OFFSET(0x000000065CEF68E8),
#endif
#if WINDOW_SIZE >= 581
  LN_OFFSET(0x000000065D604E3B),
#endif
#if WINDOW_SIZE >= 582
  LN_OFFSET(0x000000065DD101DB),
#endif
#if WINDOW_SIZE >= 583
  LN_OFFSET(0x000000065E4183F4),
#endif
#if WINDOW_SIZE >= 584
  LN_OFFSET(0x000000065EB1D4B0),
#endif
#if WINDOW_SIZE >= 585
  LN_OFFSET(0x000000065F21F43A),
#endif
#if WINDOW_SIZE >= 586
  LN_OFFSET(0x000000065F91E2BF),
#endif
#if WINDOW_SIZE >= 587
  LN_OFFSET(0x000000066001A068),
#endif
#if WINDOW_SIZE >= 588
  LN_OFFSET(0x0000000660712D60),
#endif
#if WINDOW_SIZE >= 589
  LN_OFFSET(0x0000000660E089D2),
#endif
#if WINDOW_SIZE >= 590
  LN_OFFSET(0x00000006614FB5E8),
#endif
#if WINDOW_SIZE >= 591
  LN_OFFSET(0x0000000661BEB1CB),
#endif
#if WINDOW_SIZE >= 592
  LN_OFFSET(0x00000006622D7DA6),
#endif
#if WINDOW_SIZE >= 593
  LN_OFFSET(0x00000006629C19A2),
#endif
#if WINDOW_SIZE >= 594
  LN_OFFSET(0x00000006630A85E8),
#endif
#if WINDOW_SIZE >= 595
  LN_OFFSET(0x000000066378C2A1),
#endif
#if WINDOW_SIZE >= 596
  LN_OFFSET(0x0000000663E6CFF6),
#endif
#if WINDOW_SIZE >= 597
  LN_OFFSET(0x000000066454AE10),
#endif
#if WINDOW_SIZE >= 598
  LN_OFFSET(0x0000000664C25D18),
#endif
#if WINDOW_SIZE >= 599
  LN_OFFSET(0x00000006652FDD35),
#endif
#if WINDOW_SIZE >= 600
  LN_OFFSET(0x00000006659D2E8F),
#endif
#if WINDOW_SIZE >= 601
  LN_OFFSET(0x00000006660A5150),
#endif
#if WINDOW_SIZE >= 602
  LN_OFFSET(0x000000066677459D),
#endif
#if WINDOW_SIZE >= 603
  LN_OFFSET(0x0000000666E40B9F),
#endif
#if WINDOW_SIZE >= 604
  LN_OFFSET(0x000000066750A37D),
#endif
#if WINDOW_SIZE >= 605
  LN_OFFSET(0x0000000667BD0D5E),
#endif
#if WINDOW_SIZE >= 606
  LN_OFFSET(0x0000000668294969),
#endif
#if WINDOW_SIZE >= 607
  LN_OFFSET(0x00000006689557C5),
#endif
#if WINDOW_SIZE >= 608
  LN_OFFSET(0x0000000669013897),
#endif
#if WINDOW_SIZE >= 609
  LN_OFFSET(0x00000006696CEC07),
#endif
#if WINDOW_SIZE >= 610
  LN_OFFSET(0x0000000669D8723B),
#endif
#if WINDOW_SIZE >= 611
  LN_OFFSET(0x000000066A43CB58),
#endif
#if WINDOW_SIZE >= 612
  LN_OFFSET(0x000000066AAEF784),
#endif
#if WINDOW_SIZE >= 613
  LN_OFFSET(0x000000066B19F6E5),
#endif
#if WINDOW_SIZE >= 614
  LN_OFFSET(0x000000066B84C9A0),
#endif
#if WINDOW_SIZE >= 615
  LN_OFFSET(0x000000066BEF6FDB),
#endif
#if WINDOW_SIZE >= 616
  LN_OFFSET(0x000000066C59E9BA),
#endif
#if WINDOW_SIZE >= 617
  LN_OFFSET(0x000000066CC43762),
#endif
#if WINDOW_SIZE >= 618
  LN_OFFSET(0x000000066D2E58F8),
#endif
#if WINDOW_SIZE >= 619
  LN_OFFSET(0x000000066D984EA1),
#endif
#if WINDOW_SIZE >= 620
  LN_OFFSET(0x000000066E021880),
#endif
#if WINDOW_SIZE >= 621
  LN_OFFSET(0x000000066E6BB6BA),
#endif
#if WINDOW_SIZE >= 622
  LN_OFFSET(0x000000066ED52973),
#endif
#if WINDOW_SIZE >= 623
  LN_OFFSET(0x000000066F3E70CE),
#endif
#if WINDOW_SIZE >= 624
  LN_OFFSET(0x000000066FA78CF0),
#endif
#if WINDOW_SIZE >= 625
  LN_OFFSET(0x0000000670107DFB),
#endif
#if WINDOW_SIZE >= 626
  LN_OFFSET(0x0000000670794413),
#endif
#if WINDOW_SIZE >= 627
  LN_OFFSET(0x0000000670E1DF5B),
#endif
#if WINDOW_SIZE >= 628
  LN_OFFSET(0x00000006714A4FF6),
#endif
#if WINDOW_SIZE >= 629
  LN_OFFSET(0x0000000671B29606),
#endif
#if WINDOW_SIZE >= 630
  LN_OFFSET(0x00000006721AB1AF),
#endif
#if WINDOW_SIZE >= 631
  LN_OFFSET(0x000000067282A312),
#endif
#if WINDOW_SIZE >= 632
  LN_OFFSET(0x0000000672EA6A53),
#endif
#if WINDOW_SIZE >= 633
  LN_OFFSET(0x0000000673520792),
#endif
#if WINDOW_SIZE >= 634
  LN_OFFSET(0x0000000673B97AF3),
#endif
#if WINDOW_SIZE >= 635
  LN_OFFSET(0x000000067420C496),
#endif
#if WINDOW_SIZE >= 636
  LN_OFFSET(0x000000067487E49E),
#endif
#if WINDOW_SIZE >= 637
  LN_OFFSET(0x0000000674EEDB2C),
#endif
#if WINDOW_SIZE >= 638
  LN_OFFSET(0x000000067555A861),
#endif
#if WINDOW_SIZE >= 639
  LN_OFFSET(0x0000000675BC4C5E),
#endif
#if WINDOW_SIZE >= 640
  LN_OFFSET(0x000000067622C745),
#endif
#if WINDOW_SIZE >= 641
  LN_OFFSET(0x0000000676891936),
#endif
#if WINDOW_SIZE >= 642
  LN_OFFSET(0x0000000676EF4252),
#endif
#if WINDOW_SIZE >= 643
  LN_OFFSET(0x00000006775542B9),
#endif
#if WINDOW_SIZE >= 644
  LN_OFFSET(0x0000000677BB1A8C),
#endif
#if WINDOW_SIZE >= 645
  LN_OFFSET(0x000000067820C9EC),
#endif
#if WINDOW_SIZE >= 646
  LN_OFFSET(0x00000006788650F7),
#endif
#if WINDOW_SIZE >= 647
  LN_OFFSET(0x0000000678EBAFCF),
#endif
#if WINDOW_SIZE >= 648
  LN_OFFSET(0x000000067950E692),
#endif
#if WINDOW_SIZE >= 649
  LN_OFFSET(0x0000000679B5F561),
#endif
#if WINDOW_SIZE >= 650
  LN_OFFSET(0x000000067A1ADC5B),
#endif
#if WINDOW_SIZE >= 651
  LN_OFFSET(0x000000067A7F9BA0),
#endif
#if WINDOW_SIZE >= 652
  LN_OFFSET(0x000000067AE4334E),
#endif
#if WINDOW_SIZE >= 653
  LN_OFFSET(0x000000067B48A384),
#endif
#if WINDOW_SIZE >= 654
  LN_OFFSET(0x000000067BACEC62),
#endif
#if WINDOW_SIZE >= 655
  LN_OFFSET(0x000000067C110E07),
#endif
#if WINDOW_SIZE >= 656
  LN_OFFSET(0x000000067C750891),
#endif
#if WINDOW_SIZE >= 657
  LN_OFFSET(0x000000067CD8DC1E),
#endif
#if WINDOW_SIZE >= 658
  LN_OFFSET(0x000000067D3C88CD),
#endif
#if WINDOW_SIZE >= 659
  LN_OFFSET(0x000000067DA00EBC),
#endif
#if WINDOW_SIZE >= 660
  LN_OFFSET(0x000000067E036E09),
#endif
#if WINDOW_SIZE >= 661
  LN_OFFSET(0x000000067E66A6D2),
#endif
#if WINDOW_SIZE >= 662
  LN_OFFSET(0x000000067EC9B935),
#endif
#if WINDOW_SIZE >= 663
  LN_OFFSET(0x000000067F2CA550),
#endif
#if WINDOW_SIZE >= 664
  LN_OFFSET(0x000000067F8F6B40),
#endif
#if WINDOW_SIZE >= 665
  LN_OFFSET(0x000000067FF20B22),
#endif
#if WINDOW_SIZE >= 666
  LN_OFFSET(0x0000000680548514),
#endif
#if WINDOW_SIZE >= 667
  LN_OFFSET(0x0000000680B6D933),
#endif
#if WINDOW_SIZE >= 668
  LN_OFFSET(0x000000068119079D),
#endif
#if WINDOW_SIZE >= 669
  LN_OFFSET(0x00000006817B106D),
#endif
#if WINDOW_SIZE >= 670
  LN_OFFSET(0x0000000681DCF3C0),
#endif
#if WINDOW_SIZE >= 671
  LN_OFFSET(0x00000006823EB1B4),
#endif
#if WINDOW_SIZE >= 672
  LN_OFFSET(0x0000000682A04A65),
#endif
#if WINDOW_SIZE >= 673
  LN_OFFSET(0x000000068301BDEE),
#endif
#if WINDOW_SIZE >= 674
  LN_OFFSET(0x0000000683630C6D),
#endif
#if WINDOW_SIZE >= 675
  LN_OFFSET(0x0000000683C435FE),
#endif
#if WINDOW_SIZE >= 676
  LN_OFFSET(0x0000000684253ABC),
#endif
#if WINDOW_SIZE >= 677
  LN_OFFSET(0x0000000684861AC3),
#endif
#if WINDOW_SIZE >= 678
  LN_OFFSET(0x0000000684E6D62F),
#endif
#if WINDOW_SIZE >= 679
  LN_OFFSET(0x0000000685476D1C),
#endif
#if WINDOW_SIZE >= 680
  LN_OFFSET(0x0000000685A7DFA5),
#endif
#if WINDOW_SIZE >= 681
  LN_OFFSET(0x0000000686082DE6),
#endif
#if WINDOW_SIZE >= 682
  LN_OFFSET(0x00000006866857F9),
#endif
#if WINDOW_SIZE >= 683
  LN_OFFSET(0x0000000686C85DFB),
#endif
#if WINDOW_SIZE >= 684
  LN_OFFSET(0x0000000687284005),
#endif
#if WINDOW_SIZE >= 685
  LN_OFFSET(0x000000068787FE34),
#endif
#if WINDOW_SIZE >= 686
  LN_OFFSET(0x0000000687E798A1),
#endif
#if WINDOW_SIZE >= 687
  LN_OFFSET(0x0000000688470F67),
#endif
#if WINDOW_SIZE >= 688
  LN_OFFSET(0x0000000688A662A1),
#endif
#if WINDOW_SIZE >= 689
  LN_OFFSET(0x000000068905926A),
#endif
#if WINDOW_SIZE >= 690
  LN_OFFSET(0x0000000689649EDB),
#endif
#if WINDOW_SIZE >= 691
  LN_OFFSET(0x0000000689C3880F),
#endif
#if WINDOW_SIZE >= 692
  LN_OFFSET(0x000000068A224E20),
#endif
#if WINDOW_SIZE >= 693
  LN_OFFSET(0x000000068A80F128),
#endif
#if WINDOW_SIZE >= 694
  LN_OFFSET(0x000000068ADF7141),
#endif
#if WINDOW_SIZE >= 695
  LN_OFFSET(0x000000068B3DCE84),
#endif
#if WINDOW_SIZE >= 696
  LN_OFFSET(0x000000068B9C090C),
#endif
#if WINDOW_SIZE >= 697
  LN_OFFSET(0x000000068BFA20F1),
#endif
#if WINDOW_SIZE >= 698
  LN_OFFSET(0x000000068C58164D),
#endif
#if WINDOW_SIZE >= 699
  LN_OFFSET(0x000000068CB5E93A),
#endif
#if WINDOW_SIZE >= 700
  LN_OFFSET(0x000000068D1399D0),
#endif
#if WINDOW_SIZE >= 701
  LN_OFFSET(0x000000068D712829),
#endif
#if WINDOW_SIZE >= 702
  LN_OFFSET(0x000000068DCE945E),
#endif
#if WINDOW_SIZE >= 703
  LN_OFFSET(0x000000068E2BDE87),
#endif
#if WINDOW_SIZE >= 704
  LN_OFFSET(0x000000068E8906BE),
#endif
#if WINDOW_SIZE >= 705
  LN_OFFSET(0x000000068EE60D1B),
#endif
#if WINDOW_SIZE >= 706
  LN_OFFSET(0x000000068F42F1B7),
#endif
#if WINDOW_SIZE >= 707
  LN_OFFSET(0x000000068F9FB4AA),
#endif
#if WINDOW_SIZE >= 708
  LN_OFFSET(0x000000068FFC560C),
#endif
#if WINDOW_SIZE >= 709
  LN_OFFSET(0x000000069058D5F6),
#endif
#if WINDOW_SIZE >= 710
  LN_OFFSET(0x0000000690B5347F),
#endif
#if WINDOW_SIZE >= 711
  LN_OFFSET(0x00000006911171C1),
#endif
#if WINDOW_SIZE >= 712
  LN_OFFSET(0x00000006916D8DD3),
#endif
#if WINDOW_SIZE >= 713
  LN_OFFSET(0x0000000691C988CC),
#endif
#if WINDOW_SIZE >= 714
  LN_OFFSET(0x00000006922562C5),
#endif
#if WINDOW_SIZE >= 715
  LN_OFFSET(0x0000000692811BD4),
#endif
#if WINDOW_SIZE >= 716
  LN_OFFSET(0x0000000692DCB413),
#endif
#if WINDOW_SIZE >= 717
  LN_OFFSET(0x0000000693382B98),
#endif
#if WINDOW_SIZE >= 718
  LN_OFFSET(0x000000069393827A),
#endif
#if WINDOW_SIZE >= 719
  LN_OFFSET(0x0000000693EEB8D1),
#endif
#if WINDOW_SIZE >= 720
  LN_OFFSET(0x000000069449CEB3),
#endif
#if WINDOW_SIZE >= 721
  LN_OFFSET(0x0000000694A4C439),
#endif
#if WINDOW_SIZE >= 722
  LN_OFFSET(0x0000000694FF9978),
#endif
#if WINDOW_SIZE >= 723
  LN_OFFSET(0x00000006955A4E89),
#endif
#if WINDOW_SIZE >= 724
  LN_OFFSET(0x0000000695B4E381),
#endif
#if WINDOW_SIZE >= 725
  LN_OFFSET(0x00000006960F5877),
#endif
#if WINDOW_SIZE >= 726
  LN_OFFSET(0x000000069669AD82),
#endif
#if WINDOW_SIZE >= 727
  LN_OFFSET(0x0000000696C3E2B8),
#endif
#if WINDOW_SIZE >= 728
  LN_OFFSET(0x00000006971DF830),
#endif
#if WINDOW_SIZE >= 729
  LN_OFFSET(0x000000069777EE00),
#endif
#if WINDOW_SIZE >= 730
  LN_OFFSET(0x0000000697D1C43F),
#endif
#if WINDOW_SIZE >= 731
  LN_OFFSET(0x00000006982B7B01),
#endif
#if WINDOW_SIZE >= 732
  LN_OFFSET(0x000000069885125F),
#endif
#if WINDOW_SIZE >= 733
  LN_OFFSET(0x0000000698DE8A6C),
#endif
#if WINDOW_SIZE >= 734
  LN_OFFSET(0x000000069937E340),
#endif
#if WINDOW_SIZE >= 735
  LN_OFFSET(0x0000000699911CEF),
#endif
#if WINDOW_SIZE >= 736
  LN_OFFSET(0x0000000699EA3791),
#endif
#if WINDOW_SIZE >= 737
  LN_OFFSET(0x000000069A433339),
#endif
#if WINDOW_SIZE >= 738
  LN_OFFSET(0x000000069A9C0FFF),
#endif
#if WINDOW_SIZE >= 739
  LN_OFFSET(0x000000069AF4CDF6),
#endif
#if WINDOW_SIZE >= 740
  LN_OFFSET(0x000000069B4D6D35),
#endif
#if WINDOW_SIZE >= 741
  LN_OFFSET(0x000000069BA5EDD1),
#endif
#if WINDOW_SIZE >= 742
  LN_OFFSET(0x000000069BFE4FDF),
#endif
#if WINDOW_SIZE >= 743
  LN_OFFSET(0x000000069C569373),
#endif
#if WINDOW_SIZE >= 744
  LN_OFFSET(0x000000069CAEB8A4),
#endif
#if WINDOW_SIZE >= 745
  LN_OFFSET(0x000000069D06BF85),
#endif
#if WINDOW_SIZE >= 746
  LN_OFFSET(0x000000069D5EA82C),
#endif
#if WINDOW_SIZE >= 747
  LN_OFFSET(0x000000069DB672AE),
#endif
#if WINDOW_SIZE >= 748
  LN_OFFSET(0x000000069E0E1F1E),
#endif
#if WINDOW_SIZE >= 749
  LN_OFFSET(0x000000069E65AD92),
#endif
#if WINDOW_SIZE >= 750
  LN_OFFSET(0x000000069EBD1E1F),
#endif
#if WINDOW_SIZE >= 751
  LN_OFFSET(0x000000069F1470D7),
#endif
#if WINDOW_SIZE >= 752
  LN_OFFSET(0x000000069F6BA5D1),
#endif
#if WINDOW_SIZE >= 753
  LN_OFFSET(0x000000069FC2BD1F),
#endif
#if WINDOW_SIZE >= 754
  LN_OFFSET(0x00000006A019B6D7),
#endif
#if WINDOW_SIZE >= 755
  LN_OFFSET(0x00000006A070930C),
#endif
#if WINDOW_SIZE >= 756
  LN_OFFSET(0x00000006A0C751D3),
#endif
#if WINDOW_SIZE >= 757
  LN_OFFSET(0x00000006A11DF33E),
#endif
#if WINDOW_SIZE >= 758
  LN_OFFSET(0x00000006A1747763),
#endif
#if WINDOW_SIZE >= 759
  LN_OFFSET(0x00000006A1CADE54),
#endif
#if WINDOW_SIZE >= 760
  LN_OFFSET(0x00000006A2212826),
#endif
#if WINDOW_SIZE >= 761
  LN_OFFSET(0x00000006A27754EC),
#endif
#if WINDOW_SIZE >= 762
  LN_OFFSET(0x00000006A2CD64BA),
#endif
#if WINDOW_SIZE >= 763
  LN_OFFSET(0x00000006A32357A3),
#endif
#if WINDOW_SIZE >= 764
  LN_OFFSET(0x00000006A3792DBA),
#endif
#if WINDOW_SIZE >= 765
  LN_OFFSET(0x00000006A3CEE713),
#endif
#if WINDOW_SIZE >= 766
  LN_OFFSET(0x00000006A42483C1),
#endif
#if WINDOW_SIZE >= 767
  LN_OFFSET(0x00000006A47A03D7),
#endif
#if WINDOW_SIZE >= 768
  LN_OFFSET(0x00000006A4CF6769),
#endif
#if WINDOW_SIZE >= 769
  LN_OFFSET(0x00000006A524AE88),
#endif
#if WINDOW_SIZE >= 770
  LN_OFFSET(0x00000006A579D949),
#endif
#if WINDOW_SIZE >= 771
  LN_OFFSET(0x00000006A5CEE7BE),
#endif
#if WINDOW_SIZE >= 772
  LN_OFFSET(0x00000006A623D9F9),
#endif
#if WINDOW_SIZE >= 773
  LN_OFFSET(0x00000006A678B00E),
#endif
#if WINDOW_SIZE >= 774
  LN_OFFSET(0x00000006A6CD6A10),
#endif
#if WINDOW_SIZE >= 775
  LN_OFFSET(0x00000006A722080F),
#endif
#if WINDOW_SIZE >= 776
  LN_OFFSET(0x00000006A7768A20),
#endif
#if WINDOW_SIZE >= 777
  LN_OFFSET(0x00000006A7CAF055),
#endif
#if WINDOW_SIZE >= 778
  LN_OFFSET(0x00000006A81F3ABF),
#endif
#if WINDOW_SIZE >= 779
  LN_OFFSET(0x00000006A8736972),
#endif
#if WINDOW_SIZE >= 780
  LN_OFFSET(0x00000006A8C77C7F),
#endif
#if WINDOW_SIZE >= 781
  LN_OFFSET(0x00000006A91B73F9),
#endif
#if WINDOW_SIZE >= 782
  LN_OFFSET(0x00000006A96F4FF1),
#endif
#if WINDOW_SIZE >= 783
  LN_OFFSET(0x00000006A9C3107A),
#endif
#if WINDOW_SIZE >= 784
  LN_OFFSET(0x00000006AA16B5A5),
#endif
#if WINDOW_SIZE >= 785
  LN_OFFSET(0x00000006AA6A3F85),
#endif
#if WINDOW_SIZE >= 786
  LN_OFFSET(0x00000006AABDAE2B),
#endif
#if WINDOW_SIZE >= 787
  LN_OFFSET(0x00000006AB1101A9),
#endif
#if WINDOW_SIZE >= 788
  LN_OFFSET(0x00000006AB643A10),
#endif
#if WINDOW_SIZE >= 789
  LN_OFFSET(0x00000006ABB75773),
#endif
#if WINDOW_SIZE >= 790
  LN_OFFSET(0x00000006AC0A59E2),
#endif
#if WINDOW_SIZE >= 791
  LN_OFFSET(0x00000006AC5D4170),
#endif
#if WINDOW_SIZE >= 792
  LN_OFFSET(0x00000006ACB00E2C),
#endif
#if WINDOW_SIZE >= 793
  LN_OFFSET(0x00000006AD02C02A),
#endif
#if WINDOW_SIZE >= 794
  LN_OFFSET(0x00000006AD55577A),
#endif
#if WINDOW_SIZE >= 795
  LN_OFFSET(0x00000006ADA7D42D),
#endif
#if WINDOW_SIZE >= 796
  LN_OFFSET(0x00000006ADFA3655),
#endif
#if WINDOW_SIZE >= 797
  LN_OFFSET(0x00000006AE4C7E02),
#endif
#if WINDOW_SIZE >= 798
  LN_OFFSET(0x00000006AE9EAB46),
#endif
#if WINDOW_SIZE >= 799
  LN_OFFSET(0x00000006AEF0BE31),
#endif
#if WINDOW_SIZE >= 800
  LN_OFFSET(0x00000006AF42B6D4),
#endif
#if WINDOW_SIZE >= 801
  LN_OFFSET(0x00000006AF949541),
#endif
#if WINDOW_SIZE >= 802
  LN_OFFSET(0x00000006AFE65987),
#endif
#if WINDOW_SIZE >= 803
  LN_OFFSET(0x00000006B03803B8),
#endif
#if WINDOW_SIZE >= 804
  LN_OFFSET(0x00000006B08993E4),
#endif
#if WINDOW_SIZE >= 805
  LN_OFFSET(0x00000006B0DB0A1C),
#endif
#if WINDOW_SIZE >= 806
  LN_OFFSET(0x00000006B12C6670),
#endif
#if WINDOW_SIZE >= 807
  LN_OFFSET(0x00000006B17DA8F0),
#endif
#if WINDOW_SIZE >= 808
  LN_OFFSET(0x00000006B1CED1AE),
#endif
#if WINDOW_SIZE >= 809
  LN_OFFSET(0x00000006B21FE0B9),
#endif
#if WINDOW_SIZE >= 810
  LN_OFFSET(0x00000006B270D621),
#endif
#if WINDOW_SIZE >= 811
  LN_OFFSET(0x00000006B2C1B1F8),
#endif
#if WINDOW_SIZE >= 812
  LN_OFFSET(0x00000006B312744C),
#endif
#if WINDOW_SIZE >= 813
  LN_OFFSET(0x00000006B3631D2E),
#endif
#if WINDOW_SIZE >= 814
  LN_OFFSET(0x00000006B3B3ACAF),
#endif
#if WINDOW_SIZE >= 815
  LN_OFFSET(0x00000006B40422DD),
#endif
#if WINDOW_SIZE >= 816
  LN_OFFSET(0x00000006B4547FC9),
#endif
#if WINDOW_SIZE >= 817
  LN_OFFSET(0x00000006B4A4C383),
#endif
#if WINDOW_SIZE >= 818
  LN_OFFSET(0x00000006B4F4EE1A),
#endif
#if WINDOW_SIZE >= 819
  LN_OFFSET(0x00000006B544FF9E),
#endif
#if WINDOW_SIZE >= 820
  LN_OFFSET(0x00000006B594F820),
#endif
#if WINDOW_SIZE >= 821
  LN_OFFSET(0x00000006B5E4D7AE),
#endif
#if WINDOW_SIZE >= 822
  LN_OFFSET(0x00000006B6349E58),
#endif
#if WINDOW_SIZE >= 823
  LN_OFFSET(0x00000006B6844C2D),
#endif
#if WINDOW_SIZE >= 824
  LN_OFFSET(0x00000006B6D3E13D),
#endif
#if WINDOW_SIZE >= 825
  LN_OFFSET(0x00000006B7235D98),
#endif
#if WINDOW_SIZE >= 826
  LN_OFFSET(0x00000006B772C14C),
#endif
#if WINDOW_SIZE >= 827
  LN_OFFSET(0x00000006B7C20C6A),
#endif
#if WINDOW_SIZE >= 828
  LN_OFFSET(0x00000006B8113EFF),
#endif
#if WINDOW_SIZE >= 829
  LN_OFFSET(0x00000006B860591C),
#endif
#if WINDOW_SIZE >= 830
  LN_OFFSET(0x00000006B8AF5ACF),
#endif
#if WINDOW_SIZE >= 831
  LN_OFFSET(0x00000006B8FE4428),
#endif
#if WINDOW_SIZE >= 832
  LN_OFFSET(0x00000006B94D1535),
#endif
#if WINDOW_SIZE >= 833
  LN_OFFSET(0x00000006B99BCE05),
#endif
#if WINDOW_SIZE >= 834
  LN_OFFSET(0x00000006B9EA6EA8),
#endif
#if WINDOW_SIZE >= 835
  LN_OFFSET(0x00000006BA38F72C),
#endif
#if WINDOW_SIZE >= 836
  LN_OFFSET(0x00000006BA8767A0),
#endif
#if WINDOW_SIZE >= 837
  LN_OFFSET(0x00000006BAD5C012),
#endif
#if WINDOW_SIZE >= 838
  LN_OFFSET(0x00000006BB240092),
#endif
#if WINDOW_SIZE >= 839
  LN_OFFSET(0x00000006BB72292E),
#endif
#if WINDOW_SIZE >= 840
  LN_OFFSET(0x00000006BBC039F4),
#endif
#if WINDOW_SIZE >= 841
  LN_OFFSET(0x00000006BC0E32F3),
#endif
#if WINDOW_SIZE >= 842
  LN_OFFSET(0x00000006BC5C143A),
#endif
#if WINDOW_SIZE >= 843
  LN_OFFSET(0x00000006BCA9DDD6),
#endif
#if WINDOW_SIZE >= 844
  LN_OFFSET(0x00000006BCF78FD7),
#endif
#if WINDOW_SIZE >= 845
  LN_OFFSET(0x00000006BD452A4B),
#endif
#if WINDOW_SIZE >= 846
  LN_OFFSET(0x00000006BD92AD3F),
#endif
#if WINDOW_SIZE >= 847
  LN_OFFSET(0x00000006BDE018C2),
#endif
#if WINDOW_SIZE >= 848
  LN_OFFSET(0x00000006BE2D6CE3),
#endif
#if WINDOW_SIZE >= 849
  LN_OFFSET(0x00000006BE7AA9AF),
#endif
#if WINDOW_SIZE >= 850
  LN_OFFSET(0x00000006BEC7CF34),
#endif
#if WINDOW_SIZE >= 851
  LN_OFFSET(0x00000006BF14DD81),
#endif
#if WINDOW_SIZE >= 852
  LN_OFFSET(0x00000006BF61D4A3),
#endif
#if WINDOW_SIZE >= 853
  LN_OFFSET(0x00000006BFAEB4A9),
#endif
#if WINDOW_SIZE >= 854
  LN_OFFSET(0x00000006BFFB7D9F),
#endif
#if WINDOW_SIZE >= 855
  LN_OFFSET(0x00000006C0482F95),
#endif
#if WINDOW_SIZE >= 856
  LN_OFFSET(0x00000006C094CA97),
#endif
#if WINDOW_SIZE >= 857
  LN_OFFSET(0x00000006C0E14EB3),
#endif
#if WINDOW_SIZE >= 858
  LN_OFFSET(0x00000006C12DBBF8),
#endif
#if WINDOW_SIZE >= 859
  LN_OFFSET(0x00000006C17A1273),
#endif
#if WINDOW_SIZE >= 860
  LN_OFFSET(0x00000006C1C65231),
#endif
#if WINDOW_SIZE >= 861
  LN_OFFSET(0x00000006C2127B3F),
#endif
#if WINDOW_SIZE >= 862
  LN_OFFSET(0x00000006C25E8DAC),
#endif
#if WINDOW_SIZE >= 863
  LN_OFFSET(0x00000006C2AA8985),
#endif
#if WINDOW_SIZE >= 864
  LN_OFFSET(0x00000006C2F66ED7),
#endif
#if WINDOW_SIZE >= 865
  LN_OFFSET(0x00000006C3423DAF),
#endif
#if WINDOW_SIZE >= 866
  LN_OFFSET(0x00000006C38DF61C),
#endif
#if WINDOW_SIZE >= 867
  LN_OFFSET(0x00000006C3D99829),
#endif
#if WINDOW_SIZE >= 868
  LN_OFFSET(0x00000006C42523E4),
#endif
#if WINDOW_SIZE >= 869
  LN_OFFSET(0x00000006C470995B),
#endif
#if WINDOW_SIZE >= 870
  LN_OFFSET(0x00000006C4BBF89B),
#endif
#if WINDOW_SIZE >= 871
  LN_OFFSET(0x00000006C50741B0),
#endif
#if WINDOW_SIZE >= 872
  LN_OFFSET(0x00000006C55274A7),
#endif
#if WINDOW_SIZE >= 873
  LN_OFFSET(0x00000006C59D918E),
#endif
#if WINDOW_SIZE >= 874
  LN_OFFSET(0x00000006C5E89872),
#endif
#if WINDOW_SIZE >= 875
  LN_OFFSET(0x00000006C633895F),
#endif
#if WINDOW_SIZE >= 876
  LN_OFFSET(0x00000006C67E6462),
#endif
#if WINDOW_SIZE >= 877
  LN_OFFSET(0x00000006C6C92989),
#endif
#if WINDOW_SIZE >= 878
  LN_OFFSET(0x00000006C713D8DF),
#endif
#if WINDOW_SIZE >= 879
  LN_OFFSET(0x00000006C75E7272),
#endif
#if WINDOW_SIZE >= 880
  LN_OFFSET(0x00000006C7A8F64E),
#endif
#if WINDOW_SIZE >= 881
  LN_OFFSET(0x00000006C7F3647F),
#endif
#if WINDOW_SIZE >= 882
  LN_OFFSET(0x00000006C83DBD13),
#endif
#if WINDOW_SIZE >= 883
  LN_OFFSET(0x00000006C8880016),
#endif
#if WINDOW_SIZE >= 884
  LN_OFFSET(0x00000006C8D22D95),
#endif
#if WINDOW_SIZE >= 885
  LN_OFFSET(0x00000006C91C459B),
#endif
#if WINDOW_SIZE >= 886
  LN_OFFSET(0x00000006C9664836),
#endif
#if WINDOW_SIZE >= 887
  LN_OFFSET(0x00000006C9B03571),
#endif
#if WINDOW_SIZE >= 888
  LN_OFFSET(0x00000006C9FA0D59),
#endif
#if WINDOW_SIZE >= 889
  LN_OFFSET(0x00000006CA43CFFB),
#endif
#if WINDOW_SIZE >= 890
  LN_OFFSET(0x00000006CA8D7D62),
#endif
#if WINDOW_SIZE >= 891
  LN_OFFSET(0x00000006CAD7159B),
#endif
#if WINDOW_SIZE >= 892
  LN_OFFSET(0x00000006CB2098B1),
#endif
#if WINDOW_SIZE >= 893
  LN_OFFSET(0x00000006CB6A06B2),
#endif
#if WINDOW_SIZE >= 894
  LN_OFFSET(0x00000006CBB35FA9),
#endif
#if WINDOW_SIZE >= 895
  LN_OFFSET(0x00000006CBFCA3A2),
#endif
#if WINDOW_SIZE >= 896
  LN_OFFSET(0x00000006CC45D2A9),
#endif
#if WINDOW_SIZE >= 897
  LN_OFFSET(0x00000006CC8EECCB),
#endif
#if WINDOW_SIZE >= 898
  LN_OFFSET(0x00000006CCD7F212),
#endif
#if WINDOW_SIZE >= 899
  LN_OFFSET(0x00000006CD20E28B),
#endif
#if WINDOW_SIZE >= 900
  LN_OFFSET(0x00000006CD69BE42),
#endif
#if WINDOW_SIZE >= 901
  LN_OFFSET(0x00000006CDB28543),
#endif
#if WINDOW_SIZE >= 902
  LN_OFFSET(0x00000006CDFB3799),
#endif
#if WINDOW_SIZE >= 903
  LN_OFFSET(0x00000006CE43D550),
#endif
#if WINDOW_SIZE >= 904
  LN_OFFSET(0x00000006CE8C5E74),
#endif
#if WINDOW_SIZE >= 905
  LN_OFFSET(0x00000006CED4D310),
#endif
#if WINDOW_SIZE >= 906
  LN_OFFSET(0x00000006CF1D3330),
#endif
#if WINDOW_SIZE >= 907
  LN_OFFSET(0x00000006CF657EE0),
#endif
#if WINDOW_SIZE >= 908
  LN_OFFSET(0x00000006CFADB62B),
#endif
#if WINDOW_SIZE >= 909
  LN_OFFSET(0x00000006CFF5D91C),
#endif
#if WINDOW_SIZE >= 910
  LN_OFFSET(0x00000006D03DE7C0),
#endif
#if WINDOW_SIZE >= 911
  LN_OFFSET(0x00000006D085E220),
#endif
#if WINDOW_SIZE >= 912
  LN_OFFSET(0x00000006D0CDC84A),
#endif
#if WINDOW_SIZE >= 913
  LN_OFFSET(0x00000006D1159A48),
#endif
#if WINDOW_SIZE >= 914
  LN_OFFSET(0x00000006D15D5826),
#endif
#if WINDOW_SIZE >= 915
  LN_OFFSET(0x00000006D1A501EE),
#endif
#if WINDOW_SIZE >= 916
  LN_OFFSET(0x00000006D1EC97AC),
#endif
#if WINDOW_SIZE >= 917
  LN_OFFSET(0x00000006D234196B),
#endif
#if WINDOW_SIZE >= 918
  LN_OFFSET(0x00000006D27B8737),
#endif
#if WINDOW_SIZE >= 919
  LN_OFFSET(0x00000006D2C2E11A),
#endif
#if WINDOW_SIZE >= 920
  LN_OFFSET(0x00000006D30A2720),
#endif
#if WINDOW_SIZE >= 921
  LN_OFFSET(0x00000006D3515953),
#endif
#if WINDOW_SIZE >= 922
  LN_OFFSET(0x00000006D39877BF),
#endif
#if WINDOW_SIZE >= 923
  LN_OFFSET(0x00000006D3DF826F),
#endif
#if WINDOW_SIZE >= 924
  LN_OFFSET(0x00000006D426796D),
#endif
#if WINDOW_SIZE >= 925
  LN_OFFSET(0x00000006D46D5CC5),
#endif
#if WINDOW_SIZE >= 926
  LN_OFFSET(0x00000006D4B42C80),
#endif
#if WINDOW_SIZE >= 927
  LN_OFFSET(0x00000006D4FAE8AB),
#endif
#if WINDOW_SIZE >= 928
  LN_OFFSET(0x00000006D5419150),
#endif
#if WINDOW_SIZE >= 929
  LN_OFFSET(0x00000006D588267A),
#endif
#if WINDOW_SIZE >= 930
  LN_OFFSET(0x00000006D5CEA833),
#endif
#if WINDOW_SIZE >= 931
  LN_OFFSET(0x00000006D6151686),
#endif
#if WINDOW_SIZE >= 932
  LN_OFFSET(0x00000006D65B717E),
#endif
#if WINDOW_SIZE >= 933
  LN_OFFSET(0x00000006D6A1B926),
#endif
#if WINDOW_SIZE >= 934
  LN_OFFSET(0x00000006D6E7ED87),
#endif
#if WINDOW_SIZE >= 935
  LN_OFFSET(0x00000006D72E0EAE),
#endif
#if WINDOW_SIZE >= 936
  LN_OFFSET(0x00000006D7741CA3),
#endif
#if WINDOW_SIZE >= 937
  LN_OFFSET(0x00000006D7BA1772),
#endif
#if WINDOW_SIZE >= 938
  LN_OFFSET(0x00000006D7FFFF24),
#endif
#if WINDOW_SIZE >= 939
  LN_OFFSET(0x00000006D845D3C6),
#endif
#if WINDOW_SIZE >= 940
  LN_OFFSET(0x00000006D88B9560),
#endif
#if WINDOW_SIZE >= 941
  LN_OFFSET(0x00000006D8D143FE),
#endif
#if WINDOW_SIZE >= 942
  LN_OFFSET(0x00000006D916DFA9),
#endif
#if WINDOW_SIZE >= 943
  LN_OFFSET(0x00000006D95C686C),
#endif
#if WINDOW_SIZE >= 944
  LN_OFFSET(0x00000006D9A1DE51),
#endif
#if WINDOW_SIZE >= 945
  LN_OFFSET(0x00000006D9E74162),
#endif
#if WINDOW_SIZE >= 946
  LN_OFFSET(0x00000006DA2C91AA),
#endif
#if WINDOW_SIZE >= 947
  LN_OFFSET(0x00000006DA71CF32),
#endif
#if WINDOW_SIZE >= 948
  LN_OFFSET(0x00000006DAB6FA06),
#endif
#if WINDOW_SIZE >= 949
  LN_OFFSET(0x00000006DAFC122E),
#endif
#if WINDOW_SIZE >= 950
  LN_OFFSET(0x00000006DB4117B6),
#endif
#if WINDOW_SIZE >= 951
  LN_OFFSET(0x00000006DB860AA6),
#endif
#if WINDOW_SIZE >= 952
  LN_OFFSET(0x00000006DBCAEB09),
#endif
#if WINDOW_SIZE >= 953
  LN_OFFSET(0x00000006DC0FB8EA),
#endif
#if WINDOW_SIZE >= 954
  LN_OFFSET(0x00000006DC547451),
#endif
#if WINDOW_SIZE >= 955
  LN_OFFSET(0x00000006DC991D49),
#endif
#if WINDOW_SIZE >= 956
  LN_OFFSET(0x00000006DCDDB3DC),
#endif
#if WINDOW_SIZE >= 957
  LN_OFFSET(0x00000006DD223814),
#endif
#if WINDOW_SIZE >= 958
  LN_OFFSET(0x00000006DD66A9FA),
#endif
#if WINDOW_SIZE >= 959
  LN_OFFSET(0x00000006DDAB0998),
#endif
#if WINDOW_SIZE >= 960
  LN_OFFSET(0x00000006DDEF56F8),
#endif
#if WINDOW_SIZE >= 961
  LN_OFFSET(0x00000006DE339224),
#endif
#if WINDOW_SIZE >= 962
  LN_OFFSET(0x00000006DE77BB25),
#endif
#if WINDOW_SIZE >= 963
  LN_OFFSET(0x00000006DEBBD205),
#endif
#if WINDOW_SIZE >= 964
  LN_OFFSET(0x00000006DEFFD6CE),
#endif
#if WINDOW_SIZE >= 965
  LN_OFFSET(0x00000006DF43C989),
#endif
#if WINDOW_SIZE >= 966
  LN_OFFSET(0x00000006DF87AA3F),
#endif
#if WINDOW_SIZE >= 967
  LN_OFFSET(0x00000006DFCB78FC),
#endif
#if WINDOW_SIZE >= 968
  LN_OFFSET(0x00000006E00F35C7),
#endif
#if WINDOW_SIZE >= 969
  LN_OFFSET(0x00000006E052E0AA),
#endif
#if WINDOW_SIZE >= 970
  LN_OFFSET(0x00000006E09679AF),
#endif
#if WINDOW_SIZE >= 971
  LN_OFFSET(0x00000006E0DA00E0),
#endif
#if WINDOW_SIZE >= 972
  LN_OFFSET(0x00000006E11D7645),
#endif
#if WINDOW_SIZE >= 973
  LN_OFFSET(0x00000006E160D9E8),
#endif
#if WINDOW_SIZE >= 974
  LN_OFFSET(0x00000006E1A42BD3),
#endif
#if WINDOW_SIZE >= 975
  LN_OFFSET(0x00000006E1E76C0E),
#endif
#if WINDOW_SIZE >= 976
  LN_OFFSET(0x00000006E22A9AA3),
#endif
#if WINDOW_SIZE >= 977
  LN_OFFSET(0x00000006E26DB79C),
#endif
#if WINDOW_SIZE >= 978
  LN_OFFSET(0x00000006E2B0C301),
#endif
#if WINDOW_SIZE >= 979
  LN_OFFSET(0x00000006E2F3BCDB),
#endif
#if WINDOW_SIZE >= 980
  LN_OFFSET(0x00000006E336A534),
#endif
#if WINDOW_SIZE >= 981
  LN_OFFSET(0x00000006E3797C15),
#endif
#if WINDOW_SIZE >= 982
  LN_OFFSET(0x00000006E3BC4188),
#endif
#if WINDOW_SIZE >= 983
  LN_OFFSET(0x00000006E3FEF594),
#endif
#if WINDOW_SIZE >= 984
  LN_OFFSET(0x00000006E4419844),
#endif
#if WINDOW_SIZE >= 985
  LN_OFFSET(0x00000006E484299F),
#endif
#if WINDOW_SIZE >= 986
  LN_OFFSET(0x00000006E4C6A9B0),
#endif
#if WINDOW_SIZE >= 987
  LN_OFFSET(0x00000006E5091880),
#endif
#if WINDOW_SIZE >= 988
  LN_OFFSET(0x00000006E54B7616),
#endif
#if WINDOW_SIZE >= 989
  LN_OFFSET(0x00000006E58DC27C),
#endif
#if WINDOW_SIZE >= 990
  LN_OFFSET(0x00000006E5CFFDBC),
#endif
#if WINDOW_SIZE >= 991
  LN_OFFSET(0x00000006E61227DD),
#endif
#if WINDOW_SIZE >= 992
  LN_OFFSET(0x00000006E65440E9),
#endif
#if WINDOW_SIZE >= 993
  LN_OFFSET(0x00000006E69648E8),
#endif
#if WINDOW_SIZE >= 994
  LN_OFFSET(0x00000006E6D83FE4),
#endif
#if WINDOW_SIZE >= 995
  LN_OFFSET(0x00000006E71A25E4),
#endif
#if WINDOW_SIZE >= 996
  LN_OFFSET(0x00000006E75BFAF3),
#endif
#if WINDOW_SIZE >= 997
  LN_OFFSET(0x00000006E79DBF18),
#endif
#if WINDOW_SIZE >= 998
  LN_OFFSET(0x00000006E7DF725C),
#endif
#if WINDOW_SIZE >= 999
  LN_OFFSET(0x00000006E82114C7),
#endif
#if WINDOW_SIZE >= 1000
  LN_OFFSET(0x00000006E862A663)
#endif
};
#endif /* USE_LOOKUP_TABLE */

/*---------------------------------------------------------------------------*/
static void
init(csl_nbr_t *csl_nbr)
{
  memset(csl_nbr->window, 0, sizeof(csl_nbr->window));
  csl_nbr->time_step = 0;
}
/*---------------------------------------------------------------------------*/
static uint_fast16_t
propose_channels(csl_nbr_t *csl_nbr)
{
  ufix16_t pulls[CSL_CHANNELS_COUNT] = { 0 };
  ufix16_t rewards[CSL_CHANNELS_COUNT] = { 0 };
  for(uint32_t s = 0; s < MIN(WINDOW_SIZE, csl_nbr->time_step); s++) {
    uint8_t arm = csl_nbr->window[s].arm;
    pulls[arm] += UFIX16_ONE;
    if(csl_nbr->window[s].reward) {
      rewards[arm] += UFIX16_FROM_UINT(1 << (EXPLORATION_TENDENCY_SHIFT / 2));
    }
  }

  uint_fast16_t proposed_channels = 0;
  for(uint_fast8_t i = 0; i < CSL_CHANNELS_COUNT; i++) {
    if(!pulls[i]) {
      proposed_channels |= 1 << i;
    }
  }
  if(proposed_channels) {
    return proposed_channels;
  }

#if USE_LOOKUP_TABLE
  ufix16_t intermediate = lns[MIN(WINDOW_SIZE, csl_nbr->time_step) - 1];
#else /* USE_LOOKUP_TABLE */
  ufix16_t intermediate = ufix16_multiply(
      LOG_2_E_INV_XI,
      ufix16_log2(ufix16_from_uint(MIN(WINDOW_SIZE, csl_nbr->time_step))));
#endif /* USE_LOOKUP_TABLE */

  struct result max_results[MAX_PROPOSED_CHANNELS];
  for(uint_fast8_t i = 0; i < CSL_CHANNELS_COUNT; i++) {
    ufix16_t exploitation = ufix16_divide(rewards[i], pulls[i]);
    ufix16_t exploration = ufix16_sqrt(ufix16_divide(intermediate, pulls[i]));
    ufix16_t ucb = exploitation + exploration;

    /* sorted insertion */
    bool inserted = false;
    uint_fast8_t already_inserted_results = MIN(i, MAX_PROPOSED_CHANNELS);
    for(uint_fast8_t j = 0; j < already_inserted_results; j++) {
      if(ucb > max_results[j].ucb) {
        memmove(max_results + j + 1,
            max_results + j,
            MIN(already_inserted_results - j, MAX_PROPOSED_CHANNELS - j - 1)
                * sizeof(max_results[0]));
        max_results[j].channel = i;
        max_results[j].ucb = ucb;
        inserted = true;
        break;
      }
    }

    if(!inserted && (i < MAX_PROPOSED_CHANNELS)) {
      max_results[i].channel = i;
      max_results[i].ucb = ucb;
    }
  }

  for(uint_fast8_t j = 0; j < MAX_PROPOSED_CHANNELS; j++) {
    assert(!j || (max_results[j - 1].ucb >= max_results[j].ucb));
    proposed_channels |= 1 << max_results[j].channel;
  }
  LOG_DBG("SW-UCB: proposed_channels = %u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u\n",
      proposed_channels & 1 << 15 ? 1 : 0,
      proposed_channels & 1 << 14 ? 1 : 0,
      proposed_channels & 1 << 13 ? 1 : 0,
      proposed_channels & 1 << 12 ? 1 : 0,
      proposed_channels & 1 << 11 ? 1 : 0,
      proposed_channels & 1 << 10 ? 1 : 0,
      proposed_channels & 1 << 9 ? 1 : 0,
      proposed_channels & 1 << 8 ? 1 : 0,
      proposed_channels & 1 << 7 ? 1 : 0,
      proposed_channels & 1 << 6 ? 1 : 0,
      proposed_channels & 1 << 5 ? 1 : 0,
      proposed_channels & 1 << 4 ? 1 : 0,
      proposed_channels & 1 << 3 ? 1 : 0,
      proposed_channels & 1 << 2 ? 1 : 0,
      proposed_channels & 1 << 1 ? 1 : 0,
      proposed_channels & 1 << 0 ? 1 : 0);
  return proposed_channels;
}
/*---------------------------------------------------------------------------*/
static void
take_feedback(csl_nbr_t *csl_nbr, bool successful, uint8_t channel)
{
  uint32_t entry_index = csl_nbr->time_step % WINDOW_SIZE;
  csl_nbr->window[entry_index].arm = channel;
  csl_nbr->window[entry_index].reward = successful;
  csl_nbr->time_step++;
}
/*---------------------------------------------------------------------------*/
static bool
is_exploring(csl_nbr_t *csl_nbr)
{
  uint32_t bitmap = 0;
  for(uint32_t s = 0; s < MIN(WINDOW_SIZE, csl_nbr->time_step); s++) {
    bitmap |= 1 << csl_nbr->window[s].arm;
  }

  for(uint32_t mask = 1; mask <= 1 << CSL_CHANNELS_COUNT; mask <<= 1) {
    if(!(mask & bitmap)) {
      return true;
    }
  }
  return false;
}
/*---------------------------------------------------------------------------*/
const struct csl_channel_selector csl_channel_selector_sw_ucb = {
  init,
  propose_channels,
  take_feedback,
  is_exploring,
};
/*---------------------------------------------------------------------------*/
#endif /* CSL_CHANNEL_SELECTOR_WITH_SW_UCB */

/** @} */
